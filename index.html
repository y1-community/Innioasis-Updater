<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innioasis Updater - Official Firmware Installation Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light mode colors - Modern cohesive palette */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-error: #ef4444;
            --border-primary: #e2e8f0;
            --border-secondary: #f1f5f9;
            --shadow-primary: rgba(15, 23, 42, 0.08);
            --shadow-secondary: rgba(15, 23, 42, 0.04);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-accent: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            --gradient-surface: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        [data-theme="dark"] {
            /* Dark mode colors - High contrast for accessibility */
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-tertiary: #c0c0c0;
            --accent-primary: #60a5fa;
            --accent-secondary: #a78bfa;
            --accent-success: #34d399;
            --accent-warning: #fbbf24;
            --accent-error: #f87171;
            --border-primary: #404040;
            --border-secondary: #333333;
            --shadow-primary: rgba(0, 0, 0, 0.5);
            --shadow-secondary: rgba(0, 0, 0, 0.3);
            --gradient-primary: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            --gradient-secondary: linear-gradient(135deg, #334155 0%, #475569 100%);
            --gradient-accent: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            --gradient-surface: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #16213e 25%, #0f3460 50%, #533a7d 75%, #4c1d95 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
            /* Ensure floating simulator is not clipped */
            overflow-x: auto;
            overflow-y: visible;
        }

        /* Link Styles - Theme-aware */
        a {
            color: var(--text-secondary);
            text-decoration: underline;
            text-decoration-color: var(--text-tertiary);
            text-underline-offset: 2px;
            transition: all 0.2s ease;
        }

        a:hover {
            color: var(--accent-primary);
            text-decoration-color: var(--accent-primary);
            text-decoration-thickness: 2px;
        }

        a:visited {
            color: var(--text-secondary);
            text-decoration-color: var(--text-tertiary);
        }

        a:focus {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
            border-radius: 2px;
            color: var(--accent-primary);
        }

        /* Dark mode styles removed - using light theme only */

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            /* Ensure floating simulator is not clipped */
            overflow: visible;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
            justify-content: center;
        }
        
        .header-download {
            flex-shrink: 0;
        }
        
        .header-download-btn {
            padding: 12px 24px !important;
            font-size: 1rem !important;
            font-weight: 600;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(96, 165, 250, 0.3);
            transition: all 0.2s ease;
        }
        
        .header-download-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(96, 165, 250, 0.4);
        }

        .header-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
        }

        .header-icon:hover {
            transform: scale(1.05);
        }

        .header-text {
            flex: 1;
            min-width: 300px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Download Counter Styling - Show with Pride! ðŸŽ‰ */
        .download-counter {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .counter-stat {
            text-align: center;
            background: var(--gradient-primary);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-primary);
            min-width: 120px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .counter-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .counter-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .counter-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Dark mode counter styling removed - using light theme only */

        /* Mobile responsive counter */
        @media (max-width: 768px) {
            .download-counter {
                gap: 1rem;
                margin: 15px 0;
            }
            
            .counter-stat {
                padding: 0.8rem 1rem;
                min-width: 100px;
            }
            
            .counter-number {
                font-size: 1.5rem;
            }
            
            .counter-label {
                font-size: 0.75rem;
            }
        }


        .main-content {
            background: var(--gradient-surface);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 25px 50px var(--shadow-primary);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            transition: all 0.3s ease;
        }


        .platform-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        /* Responsive platform selector spacing */
        @media (max-width: 1400px) {
            .platform-selector {
                margin: 20px 0;
                gap: 12px;
            }
        }
        
        @media (max-width: 1024px) {
            .platform-selector {
                margin: 15px 0;
                gap: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .platform-selector {
                margin: 10px 0;
                gap: 8px;
            }
        }

        .platform-card {
            background: var(--gradient-surface);
            border: 2px solid var(--border-primary);
            border-radius: 20px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px var(--shadow-secondary);
        }


        .platform-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-4px);
            box-shadow: 0 12px 28px var(--shadow-primary);
        }

        .platform-card.selected {
            border-color: var(--accent-primary);
            background: var(--gradient-surface);
            color: var(--text-primary);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }

        .platform-card .icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
        }

        .platform-card h3 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .platform-card p {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        .platform-card .status {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-success);
        }

        .platform-card .status.coming-soon {
            background: var(--accent-warning);
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .content-section.active {
            display: block;
        }

        .sub-content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .sub-content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 2rem;
            margin: 40px 0 20px 0;
            color: white;
            text-align: center;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        /* Responsive section title spacing */
        @media (max-width: 1400px) {
            .section-title {
                margin: 30px 0 15px 0;
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 1024px) {
            .section-title {
                margin: 20px 0 10px 0;
                font-size: 1.6rem;
            }
        }
        
        @media (max-width: 768px) {
            .section-title {
                margin: 15px 0 10px 0;
                font-size: 1.4rem;
            }
        }

        .info-card {
            background: var(--gradient-surface);
            padding: 32px;
            border-radius: 20px;
            border-left: 6px solid var(--accent-primary);
            margin-bottom: 24px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--shadow-secondary);
            border: 1px solid var(--border-primary);
        }


        .info-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 28px var(--shadow-primary);
        }

        .info-card h3 {
            color: var(--accent-primary);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-card p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .info-card ul, .info-card ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .info-card li {
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .code-block {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        /* Dark mode code block styling removed - using light theme only */

        .warning-box {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--accent-warning);
        }

        /* Dark mode warning box styling removed - using light theme only */

        .warning-box h4 {
            color: var(--accent-warning);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .success-box {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border: 1px solid #c3e6cb;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--accent-success);
        }

        /* Dark mode success box styling removed - using light theme only */

        .success-box h4 {
            color: var(--accent-success);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        /* Troubleshooting Cards */
        .troubleshooting-card {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            border-left: 4px solid var(--accent-primary);
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .troubleshooting-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border-left-color: var(--accent-success);
        }

        .troubleshooting-card h4 {
            color: var(--accent-primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .troubleshooting-card p {
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 0;
            font-size: 14px;
        }

        .troubleshooting-card .code-block {
            margin: 12px 0 0 0;
            font-size: 13px;
        }

        .download-btn {
            background: var(--gradient-accent);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 12px 8px;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .download-btn:active {
            transform: translateY(0);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: white;
            opacity: 0.8;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .footer a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }

        .footer a:hover {
            text-decoration: underline;
            opacity: 1;
        }

        /* App Demo Styles */
        .app-demo {
            margin: 0; /* Remove margin to let simulator truly float */
            display: flex;
            justify-content: center;
            position: relative;
            /* Container for responsive scaling */
            width: 100%;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            /* Allow content to overflow for floating effect */
            overflow: visible;
            /* Responsive padding to prevent clipping - will be overridden by JavaScript */
            padding: 0; /* Remove default padding for true floating */
            /* Floating window positioning */
            transform-origin: center center;
            z-index: 10; /* Float above the hero banner background */
        }
        
        /* Responsive app demo spacing */
        @media (max-width: 1400px) {
            .app-demo {
                margin: 15px 0;
                padding: 30px 20px;
            }
        }
        
        @media (max-width: 1024px) {
            .app-demo {
                margin: 10px 0;
                padding: 20px 15px;
            }
        }
        
        @media (max-width: 768px) {
            .app-demo {
                margin: 5px 0;
                padding: 10px;
            }
        }

        .app-window {
            background: transparent;
            border-radius: 16px;
            /* Enhanced drop shadow for floating effect - scales with transform */
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.3),
                0 8px 25px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            overflow: hidden;
            width: 1200px;
            height: 580px;
            position: relative;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
            /* Prevent responsive reflow - maintain fixed proportions */
            min-width: 1200px;
            min-height: 580px;
            max-width: 1200px;
            max-height: 580px;
            /* Scale down proportionally on smaller screens */
            transform-origin: center top;
            /* Make it float above the container */
            z-index: 10;
            /* Ensure it can extend beyond its container */
            margin: 0 auto;
            /* Ensure shadow scales with the element */
            transform-style: preserve-3d;
            /* Prevent any internal layout changes */
            flex-shrink: 0;
            flex-grow: 0;
        }

        /* Responsive scaling - maintain proportions like a screenshot */
        /* PNG-like scaling - simple and effective */
        .app-demo {
            transform-origin: center top;
            transition: transform 0.2s ease;
            overflow: visible;
            will-change: transform;
        }

        /* Screenshot fallback styles - match simulator exactly */
        #simulator-screenshot {
            transition: opacity 0.3s ease;
            /* Ensure it behaves like the simulator */
            flex-shrink: 0;
            flex-grow: 0;
            min-width: 1200px;
            max-width: 1200px;
            min-height: 580px;
            max-height: 580px;
            transform-origin: center top;
        }

        #simulator-screenshot:hover {
            transform: scale(1.02);
            transition: transform 0.2s ease;
        }


        .app-window.expanded {
            width: 1400px;
        }

        .app-window.installation-mode {
            width: 1600px;
        }

        /* Mobile-first responsive design */
        @media (max-width: 768px) {
            /* Hide simulator completely on mobile */
            .app-demo {
                display: none !important;
            }
            
            /* Mobile message is hidden by default, shown when needed */
            .mobile-only {
                display: none;
            }
            
            .mobile-only.show {
                display: block !important;
            }
            
            /* Mobile-optimized hero section */
            .hero-banner {
                padding: 2rem 1rem;
                text-align: center;
            }
            
            .hero-banner h1 {
                font-size: 2.2rem;
                line-height: 1.2;
                margin-bottom: 1rem;
            }
            
            .hero-banner p {
                font-size: 1.1rem;
                margin-bottom: 2rem;
                max-width: 100%;
            }
            
            /* Mobile-optimized feature grid */
            .feature-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 2rem 1rem;
            }
            
            .feature-card {
                padding: 1.5rem;
                text-align: center;
            }
            
            .feature-card h3 {
                font-size: 1.3rem;
                margin-bottom: 0.5rem;
            }
            
            .feature-card p {
                font-size: 0.95rem;
                line-height: 1.5;
            }
            
            /* Mobile-optimized quick start */
            .quick-start {
                padding: 2rem 1rem;
            }
            
            .quick-start h2 {
                font-size: 1.8rem;
                margin-bottom: 1.5rem;
            }
            
            .quick-start ol {
                padding-left: 1.5rem;
                font-size: 0.95rem;
                line-height: 1.6;
            }
            
            .quick-start li {
                margin-bottom: 1rem;
            }
            
            /* Mobile-optimized CTA section */
            .cta-section {
                padding: 3rem 1rem;
                text-align: center;
            }
            
            .cta-section h2 {
                font-size: 2rem;
                margin-bottom: 1rem;
            }
            
            .cta-section p {
                font-size: 1rem;
                margin-bottom: 2rem;
                max-width: 100%;
            }
            
            .cta-buttons {
                flex-direction: column;
                gap: 1rem;
                max-width: 300px;
                margin: 0 auto;
            }
            
            .cta-buttons .btn {
                width: 100%;
                justify-content: center;
                padding: 1rem 2rem;
                font-size: 1.1rem;
            }
            
            /* Mobile-optimized footer */
            .footer {
                padding: 2rem 1rem;
            }
            
            .footer-content {
                flex-direction: column;
                gap: 2rem;
                text-align: center;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
            
            .footer-links a {
                font-size: 1rem;
                padding: 0.5rem 0;
            }
            
            .footer-bottom {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .social-links {
                justify-content: center;
            }
            
            /* Mobile-optimized container */
            .container {
                padding: 0 1rem;
            }
            
            /* Mobile-optimized text */
            body {
                font-size: 16px;
                line-height: 1.6;
            }
            
            h1, h2, h3, h4, h5, h6 {
                line-height: 1.3;
            }
            
            /* Mobile-optimized buttons */
            .btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
                min-height: 48px; /* Touch-friendly */
            }
            
            /* Mobile-optimized theme toggle */
            .theme-toggle {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
        }
        
        /* Tablet responsive design */
        @media (min-width: 769px) and (max-width: 1024px) {
            .hero-banner h1 {
                font-size: 3rem;
            }
            
            .feature-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }
            
            .cta-buttons {
                flex-direction: row;
                justify-content: center;
            }
        }
        
        .app-window.windows {
            border-radius: 0;
        }
        
        .app-window.mac {
            border-radius: 12px;
        }
        
        .app-content {
            width: 100%;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            position: relative;
            top: 0;
            left: 0;
            /* Prevent any internal reflow - scale like PNG */
            overflow: hidden;
            display: flex;
            min-height: 530px;
            /* Force all children to maintain their positions */
            transform-origin: top left;
        }

        .app-left-panel {
            background: var(--bg-tertiary);
            padding: 24px;
            width: 360px; /* Fixed width instead of percentage */
            min-width: 360px;
            max-width: 360px;
            border-right: 1px solid var(--border-primary);
            transition: all 0.3s ease;
            flex-shrink: 0;
            /* Prevent any internal reflow */
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .app-left-panel.hidden {
            display: none;
        }

        .app-right-panel {
            background: var(--bg-secondary);
            padding: 24px;
            width: 840px; /* Fixed width instead of percentage */
            min-width: 840px;
            max-width: 840px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            /* Prevent any internal reflow */
            overflow: hidden;
        }

        .app-right-panel.expanded {
            width: 100% !important;
            min-width: 100% !important;
            max-width: 100% !important;
            flex: 1 !important;
        }

        /* Responsive simulator sizing for intermediate widths */
        @media (max-width: 1400px) and (min-width: 1201px) {
            .app-window {
                width: 1400px;
                transform: scale(0.875); /* 1400/1600 = 0.875 */
                transform-origin: center top;
            }
            
            .app-window.installation-mode {
                width: 1400px;
            }
        }

        @media (max-width: 1200px) and (min-width: 1001px) {
            .app-window {
                width: 1200px;
                transform: scale(0.75); /* 1200/1600 = 0.75 */
                transform-origin: center top;
            }
            
            .app-window.installation-mode {
                width: 1200px;
            }
        }

        @media (max-width: 1000px) and (min-width: 769px) {
            .app-window {
                width: 1000px;
                transform: scale(0.625); /* 1000/1600 = 0.625 */
                transform-origin: center top;
            }
            
            .app-window.installation-mode {
                width: 1000px;
            }
        }

        /* Ensure modals within app-content scale with the simulator - REMOVED STATIC SCALING */
        /* Modal scaling is now handled dynamically by JavaScript to match simulator scaling exactly */

        /* Additional breakpoints for smoother transitions */
        @media (max-width: 1600px) and (min-width: 1401px) {
            .app-window {
                width: 1600px;
                transform: scale(1);
                transform-origin: center top;
            }
        }

        @media (max-width: 900px) and (min-width: 769px) {
            .app-window {
                width: 900px;
                transform: scale(0.5625); /* 900/1600 = 0.5625 */
                transform-origin: center top;
            }
            
            .app-window.installation-mode {
                width: 900px;
            }
            
            /* Modal scaling removed - handled by JavaScript */
        }

        /* Prevent all internal elements from reflowing - scale like PNG */
        .app-left-panel *,
        .app-right-panel * {
            box-sizing: border-box;
        }

        .app-section,
        .app-status,
        .app-rom-list,
        .app-action-buttons,
        .app-header {
            /* Prevent any responsive behavior */
            flex-shrink: 0;
        }

        .app-section {
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .app-section:last-of-type {
            margin-bottom: 24px;
        }

        .app-section label {
            color: var(--text-primary);
            font-size: 12px;
            min-width: 80px;
            font-weight: 500;
        }

        .app-select {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            flex: 1;
            transition: all 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23FF69B4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 12px;
            padding-right: 28px;
        }

        .app-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
        }

        .app-icon {
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            margin-left: 6px;
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
            position: relative;
        }

        .app-icon:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.5);
        }

        .app-icon:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 122, 255, 0.3);
        }

        .app-icon:hover::after {
            content: "Try Type A System Software first. If your scroll wheel doesn't respond after installation, install one of the Type B options.";
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            max-width: 300px;
            white-space: normal;
            text-align: center;
            box-shadow: 0 4px 12px var(--shadow-primary);
            border: 1px solid var(--border-primary);
            z-index: 1000;
            pointer-events: none;
        }

        .app-btn-small {
            background: #8E8E93;
            color: #ffffff;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            margin-left: 4px;
        }

        .app-btn-small:hover {
            background: var(--accent-primary);
            opacity: 0.8;
            transform: translateY(-1px);
        }

        .app-rom-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 0 4px;
        }

        .app-rom-list-title {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 14px;
        }

        .app-rom-count {
            color: var(--text-secondary);
            font-size: 12px;
            background: var(--bg-tertiary);
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid var(--border-primary);
        }

        .app-rom-list {
            background: transparent;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 16px;
            margin: 0 0 24px 0;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 2px 8px var(--shadow-secondary);
            flex: 1;
            min-height: 0;
        }

        .app-rom-item {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-primary);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .app-rom-item.selected {
            background: linear-gradient(135deg, #6B73FF 0%, #8B5CF6 100%);
            border-color: #6B73FF;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(107, 115, 255, 0.3);
        }

        .app-rom-item:hover {
            background: var(--bg-secondary);
            border-color: var(--accent-primary);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .app-rom-item.selected:hover {
            background: linear-gradient(135deg, #7C3AED 0%, #A855F7 100%);
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(107, 115, 255, 0.4);
        }

        .app-rom-item.selected .app-rom-badge,
        .app-rom-item.selected .app-rom-desc {
            color: rgba(255, 255, 255, 0.9);
        }

        /* Selection animation */
        .app-rom-item.selecting {
            animation: selectPulse 0.3s ease-out;
        }

        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* Focus styles for accessibility */
        .app-rom-item:focus {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
        }

        .app-rom-item.selected:focus {
            outline-color: #ffffff;
        }

        /* Selection indicator */
        .app-rom-selection-indicator {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .app-rom-item.selected .app-rom-selection-indicator {
            border-color: #ffffff;
            background: #ffffff;
        }

        .app-rom-selection-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: transparent;
            transition: all 0.2s ease;
        }

        .app-rom-item.selected .app-rom-selection-indicator::before {
            background: #6B73FF;
        }

        /* ROM content wrapper */
        .app-rom-content {
            flex: 1;
            min-width: 0;
        }

        /* Selection status indicator */
        .app-selection-status {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 12px 16px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .app-selection-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .app-selection-name {
            color: var(--text-primary);
            font-weight: 600;
            flex: 1;
        }

        /* ===== DARK MODE STYLES FOR APP SIMULATION REMOVED - USING LIGHT THEME ONLY ===== */

        /* Dark mode app simulation styles removed - using light theme only */

        /* Header styles already inherit from parent */

        /* Dark mode ROM list and UI styles removed - using light theme only */

        /* Dark mode header and action button styles removed - using light theme only */

        /* Dark mode status and progress styles removed - using light theme only */

        /* Dark mode modal styles removed - using light theme only */

        /* Dark mode styles for installation dialog */
        body[data-theme="dark"] .app-dialog-overlay {
            background: rgba(0, 0, 0, 0.8);
        }

        body[data-theme="dark"] .app-dialog {
            background: #1a1a1a;
            border: 1px solid #333333;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8);
        }

        body[data-theme="dark"] .app-dialog-header {
            border-bottom: 1px solid #333333;
        }

        body[data-theme="dark"] .app-dialog-header h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] .app-dialog-close {
            color: #b0b0b0;
        }

        body[data-theme="dark"] .app-dialog-close:hover {
            background: #333333;
        }

        body[data-theme="dark"] .app-dialog-content p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .app-dialog-option {
            background: #2a2a2a;
            border: 1px solid #333333;
        }

        body[data-theme="dark"] .app-dialog-option strong {
            color: #ffffff;
        }

        body[data-theme="dark"] .app-dialog-option p {
            color: #b0b0b0;
        }

        body[data-theme="dark"] .app-dialog-btn-primary {
            background: #4a5568;
            color: #ffffff;
            border: 1px solid #718096;
        }

        body[data-theme="dark"] .app-dialog-btn-primary:hover {
            background: #2d3748;
            border-color: #4a5568;
        }

        body[data-theme="dark"] .app-dialog-btn-secondary {
            background: #333333;
            color: #e0e0e0;
            border: 1px solid #444444;
        }

        body[data-theme="dark"] .app-dialog-btn-secondary:hover {
            background: #444444;
            border-color: #555555;
        }

        .app-rom-day {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 12px;
            display: block;
        }

        .app-rom-info {
            color: var(--text-primary);
            font-size: 10px;
            display: block;
            margin: 2px 0;
        }

        .app-rom-badge {
            font-size: 10px;
            font-weight: 500;
            color: var(--text-primary);
            display: inline-block;
            margin-top: 4px;
        }

        .app-rom-desc {
            color: var(--text-primary);
            font-size: 9px;
            margin-top: 4px;
            line-height: 1.3;
        }

        /* Settings Modal */
        .app-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(2px);
            border-radius: 12px;
            /* Ensure modal is contained within simulator */
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
        }

        .app-modal {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 24px;
            max-width: 450px;
            width: 85%;
            max-height: 70vh;
            overflow-y: auto;
            border: 1px solid var(--border-primary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        .app-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-primary);
        }

        .app-modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .app-modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .app-modal-close:hover {
            background: var(--bg-tertiary);
        }

        .app-modal-section {
            margin-bottom: 20px;
        }

        .app-modal-section h4 {
            color: var(--text-primary);
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
        }

        .app-modal-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .app-modal-checkbox input[type="checkbox"] {
            margin-right: 8px;
        }

        .app-modal-checkbox label {
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
        }

        .app-modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--border-primary);
        }

        .app-modal-tools-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .app-modal-tool-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .app-modal-tool-btn-primary {
            background: #4a5568;
            color: white;
            border: 1px solid #718096;
        }

        .app-modal-tool-btn-primary:hover {
            background: #2d3748;
            border-color: #4a5568;
            transform: translateY(-1px);
        }

        .app-modal-tool-btn-secondary {
            background: #374151;
            color: white;
            border: 1px solid #4B5563;
        }

        .app-modal-tool-btn-secondary:hover {
            background: #4B5563;
            border-color: #6B7280;
            transform: translateY(-1px);
        }

        .app-modal-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .app-modal-btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .app-modal-btn-primary:hover {
            opacity: 0.9;
        }

        .app-modal-btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }

        .app-modal-btn-secondary:hover {
            background: var(--border-primary);
        }

        /* Settings Modal Tabs */
        .app-modal-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-primary);
            margin-bottom: 20px;
        }

        .app-modal-tab {
            background: none;
            border: none;
            padding: 12px 20px;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 500;
        }

        .app-modal-tab.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .app-modal-tab:hover {
            color: var(--text-primary);
        }

        .app-modal-content {
            min-height: 200px;
        }

        .app-modal-content .app-dialog-icon {
            font-size: 32px;
            margin-bottom: 16px;
            display: block;
            text-align: center;
        }
        
        .app-modal-icon {
            display: block;
            text-align: center;
        }

        .app-modal-tab-content {
            display: block;
        }

        .app-modal-description {
            color: var(--text-secondary);
            font-size: 13px;
            margin-bottom: 16px;
        }

        .app-modal-dropdown-group {
            margin-bottom: 20px;
        }

        .app-modal-label {
            display: block;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .app-modal-select {
            width: 100%;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: 10px 12px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        .app-modal-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .app-modal-radio-group {
            margin-bottom: 16px;
        }

        .app-modal-radio {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .app-modal-radio input[type="radio"] {
            margin-right: 8px;
        }

        .app-modal-radio label {
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
        }

        .app-modal-method-info {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            margin-top: 12px;
        }

        .app-modal-method-info p {
            margin: 4px 0;
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Installation Dialog Styles */
        .app-dialog-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(3px);
            border-radius: 12px;
            /* Ensure dialog is contained within simulator */
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
        }

        .app-dialog {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            border: 1px solid var(--border-primary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            position: relative;
            text-align: center;
        }

        .app-dialog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-primary);
        }

        .app-dialog-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .app-dialog-close {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .app-dialog-close:hover {
            background: var(--bg-tertiary);
        }

        .app-dialog-content {
            margin-bottom: 20px;
            text-align: left;
        }

        .app-dialog-content p {
            color: var(--text-primary);
            font-size: 14px;
            margin-bottom: 12px;
        }

        .app-dialog-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 16px 0;
        }

        .app-dialog-option {
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border-primary);
        }

        .app-dialog-option strong {
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
        }

        .app-dialog-option p {
            color: var(--text-secondary);
            font-size: 13px;
            margin: 4px 0 0 0;
        }

        .app-dialog-note {
            font-size: 12px;
            color: var(--text-secondary);
            font-style: italic;
            margin-top: 12px;
        }

        .app-dialog-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .app-dialog-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .app-dialog-btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .app-dialog-btn-primary:hover {
            opacity: 0.9;
        }

        /* Info Modal Styles */
        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000001;
            display: none;
            align-items: center;
            justify-content: center;
            /* Ensure modal is not affected by any parent transforms */
            transform: none !important;
            /* Ensure modal is always visible when shown */
            visibility: visible !important;
            opacity: 1 !important;
        }

        .info-modal.show {
            display: flex;
        }

        .info-modal-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .info-modal-close {
            position: absolute;
            top: 12px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6c757d;
        }

        .info-modal h3 {
            margin: 0 0 16px 0;
            color: #2c3e50;
        }

        .info-modal p {
            margin: 0 0 12px 0;
            line-height: 1.6;
        }

        .info-modal .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 12px;
            margin: 16px 0;
        }

        .info-modal .highlight strong {
            color: #856404;
        }

        /* Dark mode support for info modal */
        body[data-theme="dark"] .info-modal-content {
            background: #2c2c2e;
            color: #ffffff;
        }

        body[data-theme="dark"] .info-modal h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] .info-modal p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .info-modal .highlight {
            background: #3a3a3c;
            border-color: #5a5a5c;
        }

        body[data-theme="dark"] .info-modal .highlight strong {
            color: #ffd700;
        }

        body[data-theme="dark"] .info-modal-close {
            color: #e0e0e0;
        }

        .app-dialog-icon {
            font-size: 32px;
            margin-bottom: 16px;
                display: block;
        }

        .app-dialog-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .app-dialog-message {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 24px;
        }

        .app-dialog-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .app-dialog-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 80px;
        }

        .app-dialog-btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .app-dialog-btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .app-dialog-btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-primary);
        }

        .app-dialog-btn-secondary:hover {
            background: var(--border-primary);
        }

        .app-download-btn {
            background: #8E8E93;
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: auto;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(142, 142, 147, 0.3);
            flex-shrink: 0;
        }

        .app-download-btn:hover {
            background: #6D6D70;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(142, 142, 147, 0.4);
        }

        .app-download-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 122, 255, 0.3);
        }

        .app-download-btn:disabled {
            background: var(--bg-tertiary);
            color: var(--text-tertiary);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .app-creator {
            color: var(--text-tertiary);
            font-size: 10px;
            font-weight: 500;
        }

        .app-creator-link {
            color: var(--accent-primary);
            text-decoration: none;
        }

        .app-creator-link:hover {
            text-decoration: underline;
        }

        .completed-text {
            color: var(--accent-success);
            font-weight: bold;
        }

        .app-action-buttons {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .app-action-btn {
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 10px;
            cursor: pointer;
            color: #ffffff;
            transition: all 0.2s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .app-action-btn:hover {
            opacity: 0.8;
            transform: translateY(-1px);
        }

        .app-action-btn.green { 
            background: #10b981; 
            border: 1px solid #059669;
            color: white;
        }
        .app-action-btn.red { 
            background: #ef4444; 
            border: 1px solid #dc2626;
            color: white;
        }
        .app-action-btn.blue { 
            background: #3b82f6; 
            border: 1px solid #2563eb;
            color: white;
        }

        .app-status {
            color: var(--text-primary);
            font-size: 12px;
            margin-bottom: 20px;
            font-weight: 500;
            background: transparent;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 12px 16px;
            box-shadow: 0 2px 8px var(--shadow-secondary);
        }

        .app-status strong {
            font-size: 10px;
            font-weight: 600;
            display: block;
            margin-bottom: 4px;
            text-align: left;
        }

        .app-getting-ready {
            color: var(--text-primary);
            font-size: 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background: transparent;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
            box-shadow: 0 2px 8px var(--shadow-secondary);
        }

        .app-getting-ready strong {
            display: block;
            margin-bottom: 16px;
            text-align: left;
        }

        .app-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 11px;
            line-height: 1.5;
        }

        .app-step-icon {
            font-size: 14px;
            margin-top: 2px;
        }
        
        .app-step-image {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            object-fit: contain;
            vertical-align: middle;
        }
        
        .app-instruction-image {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            flex: 1;
            background: transparent;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px var(--shadow-secondary);
        }
        
        .app-main-image {
            max-width: 100%;
            max-height: 250px;
            width: auto;
            height: auto;
            object-fit: contain;
            display: block;
        }

        .app-text-fallback {
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-primary);
        }

        .app-progress-container {
            margin: 4px 0 0 0;
            background: transparent;
            border-radius: 0;
            padding: 0;
            border: none;
        }

        .app-progress-bar {
            width: 100%;
            height: 3px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            overflow: hidden;
            margin: 2px 0 0 0;
        }

        .app-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-success));
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .app-progress-text {
            color: var(--text-primary);
            font-size: 9px;
            text-align: left;
            margin: 1px 0 0 0;
            line-height: 1.2;
        }

        .app-text-fallback h4 {
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 16px;
        }

        .app-text-fallback p {
            color: var(--text-secondary);
            font-size: 14px;
            margin: 0;
        }
        
        .app-disclaimer {
            font-size: 10px;
            color: var(--text-tertiary);
            font-style: italic;
            margin: 4px 0 8px 0;
            text-align: center;
        }

        .app-version-select {
            margin-top: 8px;
            display: flex;
            gap: 8px;
        }

        .app-version {
            background: #38383a;
            color: #8e8e93;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
        }

        .app-version.selected {
            background: #007aff;
            color: #ffffff;
        }

        .app-labs {
            position: absolute;
            bottom: 40px;
            right: 24px;
            color: #8e8e93;
            font-size: 10px;
            font-weight: 500;
        }

        .app-disclaimer-outside {
            text-align: center;
            font-size: 11px;
            color: var(--text-secondary);
            margin: 10px 0 20px 0;
            font-style: italic;
        }

        /* Hero Banner Styles */
        .hero-banner {
            background: var(--gradient-primary);
            padding: 60px 20px; /* Equal padding top and bottom for floating effect */
            text-align: center;
            margin-bottom: 20px;
            border-radius: 20px;
            position: relative;
            /* Allow simulator to float above and below */
            overflow: visible;
            /* Ensure floating effect is not clipped */
            z-index: 1;
            /* Prepare for dynamic wallpaper backgrounds and height scaling */
            transition: background-image 0.5s ease, height 0.3s ease, min-height 0.3s ease, padding 0.3s ease;
            /* Dynamic height - will be set by JavaScript */
            min-height: 400px;
            /* Ensure content is properly contained */
            display: flex;
            flex-direction: column;
            justify-content: center;
            /* Enhanced floating window effect */
            box-shadow: 
                0 30px 80px rgba(0, 0, 0, 0.3),
                0 15px 40px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1);
        }
        
        /* Ensure hero content is above wallpaper overlay */
        .hero-content {
            position: relative;
            z-index: 2;
        }
        
        /* Wallpaper overlay styling */
        .wallpaper-overlay {
            z-index: 1;
        }
        
        /* Responsive hero banner spacing */
        @media (max-width: 1400px) {
            .hero-banner {
                margin-bottom: 15px;
                padding: 30px 20px 15px 20px;
            }
            
            .app-disclaimer-outside {
                margin: 5px 0 15px 0;
            }
        }
        
        @media (max-width: 1024px) {
            .hero-banner {
                margin-bottom: 10px;
                padding: 20px 15px 10px 15px;
            }
            
            .app-disclaimer-outside {
                margin: 5px 0 10px 0;
            }
        }

        .hero-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            margin-top: 20px;
        }

        .hero-content h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: white;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
            border: 2px solid var(--accent-primary);
        }

        .btn-primary:hover {
            background: transparent;
            color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: white;
            color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
        }

        /* Light mode button fixes */
        [data-theme="light"] .btn-primary {
            background: #3b82f6;
            color: white;
            border: 2px solid #2563eb;
        }

        [data-theme="light"] .btn-primary:hover {
            background: #2563eb;
            border-color: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        [data-theme="light"] .btn-secondary {
            background: transparent;
            color: #3b82f6;
            border: 2px solid #3b82f6;
        }

        [data-theme="light"] .btn-secondary:hover {
            background: #3b82f6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        /* Light mode app action buttons */
        [data-theme="light"] .app-action-btn {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #e2e8f0;
        }

        [data-theme="light"] .app-action-btn:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        [data-theme="light"] .app-action-btn.green {
            background: #10b981;
            border: 1px solid #059669;
            color: white;
        }

        [data-theme="light"] .app-action-btn.red {
            background: #ef4444;
            border: 1px solid #dc2626;
            color: white;
        }

        [data-theme="light"] .app-action-btn.blue {
            background: #3b82f6;
            border: 1px solid #2563eb;
            color: white;
        }

        [data-theme="light"] .app-action-btn.green:hover {
            background: #059669;
            border-color: #047857;
        }

        [data-theme="light"] .app-action-btn.red:hover {
            background: #dc2626;
            border-color: #b91c1c;
        }

        [data-theme="light"] .app-action-btn.blue:hover {
            background: #2563eb;
            border-color: #1d4ed8;
        }

        /* Light mode text readability fixes */
        [data-theme="light"] .app-rom-info {
            color: #374151;
        }

        [data-theme="light"] .app-rom-badge {
            color: #1f2937;
        }

        [data-theme="light"] .app-creator {
            color: #4b5563;
        }

        [data-theme="light"] .app-creator a {
            color: #3b82f6;
        }

        [data-theme="light"] .app-rom-day {
            color: #374151;
        }

        [data-theme="light"] .app-rom-desc {
            color: #6b7280;
        }

        /* Dark mode hero button fixes */
        body[data-theme="dark"] .btn-primary {
            background: #3b82f6;
            color: white;
            border: 2px solid #2563eb;
        }

        body[data-theme="dark"] .btn-primary:hover {
            background: #2563eb;
            border-color: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        body[data-theme="dark"] .btn-secondary {
            background: transparent;
            color: #60a5fa;
            border: 2px solid #60a5fa;
        }

        body[data-theme="dark"] .btn-secondary:hover {
            background: #3b82f6;
            color: white;
            border-color: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        /* Install Guide Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999999;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: white;
            color: #2c3e50;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            position: relative;
            margin: auto;
            animation: modalSlideIn 0.3s ease-out;
            box-sizing: border-box;
        }

        /* Dark mode support for modal */
        body[data-theme="dark"] .modal-content {
            background: #2c2c2e;
            color: #ffffff;
        }

        /* Platform card styling for light mode */
        .platform-card {
            background: #f8f9fa;
            border: 2px solid #e2e8f0;
            color: #2c3e50;
        }

        .platform-card h3 {
            color: #2c3e50;
        }

        .platform-card p {
            color: #6c757d;
        }

        /* Dark mode support for platform cards */
        body[data-theme="dark"] .platform-card {
            background: #3a3a3c;
            border-color: #48484a;
            color: #ffffff;
        }

        body[data-theme="dark"] .platform-card h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] .platform-card p {
            color: #e0e0e0;
        }

        /* Step styling for light mode */
        .step {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .step h4 {
            color: #2c3e50;
        }

        .step p {
            color: #6c757d;
        }

        .step li {
            color: #6c757d;
        }

        /* Dark mode support for steps */
        body[data-theme="dark"] .step {
            background: #3a3a3c;
            color: #ffffff;
        }

        body[data-theme="dark"] .step h4 {
            color: #ffffff;
        }

        body[data-theme="dark"] .step p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .step li {
            color: #e0e0e0;
        }

        /* Ensure modal content inherits theme properly */
        body[data-theme="dark"] .modal-content .step {
            background: #3a3a3c;
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .step h4 {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .step p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .modal-content .step li {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .modal-content .platform-card {
            background: #3a3a3c;
            border-color: #48484a;
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .platform-card h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .platform-card p {
            color: #e0e0e0;
        }

        /* Additional dark mode styles for guide modal */
        body[data-theme="dark"] .modal-content .step h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .step h4 {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .step strong {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .highlight {
            background: #2a2a2a;
            border: 1px solid #444444;
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .highlight strong {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .highlight p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .modal-content .step-content {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .modal-content .step-content h4 {
            color: #ffffff;
        }

        body[data-theme="dark"] .modal-content .step-content p {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .modal-content .step-content strong {
            color: #ffffff;
        }

        /* Download section styling for light mode */
        .download-section {
            background: white;
            border: 1px solid #e2e8f0;
            color: #2c3e50;
        }

        .download-section h5 {
            color: #2c3e50;
        }

        .download-section p {
            color: #6c757d;
        }

        /* Dark mode support for download sections */
        body[data-theme="dark"] .download-section {
            background: #2c2c2e;
            border-color: #48484a;
            color: #ffffff;
        }

        body[data-theme="dark"] .download-section h5 {
            color: #ffffff;
        }

        body[data-theme="dark"] .download-section p {
            color: #e0e0e0;
        }

        /* Platform selector */
        .platform-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 20px;
        }

        .platform-card {
            background: #f8f9fa;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        /* Automatic dark mode detection removed - using light theme only */

        .platform-card:hover {
            border-color: #ff6b35;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .platform-card.selected {
            border-color: #ff6b35;
            background: #f8f9fa;
        }

        /* Dark mode support for selected platform cards */
        body[data-theme="dark"] .platform-card.selected {
            background: #3a3a3c;
            border-color: #ff6b35;
        }

        .platform-card .icon {
            font-size: 2rem;
            margin-bottom: 8px;
            display: block;
        }

        .platform-card h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .platform-card p {
            font-size: 0.8rem;
            opacity: 0.7;
            line-height: 1.3;
        }

        .platform-card .status {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #00d4aa;
        }

        .platform-card .status.preview {
            background: #ffb800;
        }

        /* Installation guide content */
        .installation-guide {
            padding: 20px;
            display: none;
        }

        .installation-guide.show {
            display: block;
        }

        /* Progress bar */
        .progress-bar {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }

        /* Dark mode progress bar styles */
        body[data-theme="dark"] .progress-bar {
            color: #ffffff;
        }

        body[data-theme="dark"] .progress-step {
            color: #ffffff;
        }

        body[data-theme="dark"] .progress-step.active {
            color: #ffffff;
        }

        body[data-theme="dark"] .progress-step.completed {
            color: #ffffff;
        }

        .progress-line {
            flex: 1;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            position: relative;
            margin: 0 20px;
        }

        .progress-line .fill {
            height: 100%;
            background: #ff6b35;
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            margin: 0 8px;
            min-width: 60px;
        }

        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-number {
            background: #ff6b35;
            color: white;
        }

        .progress-step.completed .step-number {
            background: #00d4aa;
            color: white;
        }

        .step-label {
            font-size: 12px;
            font-weight: 500;
            color: #6c757d;
            text-align: center;
            margin-top: 4px;
            white-space: nowrap;
        }

        .progress-step.active .step-label {
            color: #ff6b35;
        }

        .progress-step.completed .step-label {
            color: #00d4aa;
        }

        /* Step content */
        .step {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }

        .step h4 {
            color: #2c3e50;
            margin-bottom: 16px;
            font-size: 1.25rem;
        }

        .step p {
            color: #6c757d;
            margin-bottom: 16px;
            line-height: 1.6;
        }

        .step ol, .step ul {
            color: #6c757d;
            margin-left: 20px;
            margin-bottom: 16px;
        }

        .step li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        /* Checklist */
        .checklist {
            margin: 20px 0;
        }

        .checklist-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .checklist-item.optional-item {
            opacity: 0.8;
            border-style: dashed;
        }

        .checklist-content h5 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .checklist-content p {
            color: #6c757d;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .checklist-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .info-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .info-btn:hover {
            background: #5a6268;
        }

        .skip-link {
            color: #6c757d;
            text-decoration: none;
            font-size: 0.8rem;
            font-style: italic;
        }

        .skip-link:hover {
            color: #ff6b35;
            text-decoration: underline;
        }

        /* Download section */
        .download-section {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .download-section h5 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .download-section p {
            color: #6c757d;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        /* Code block */
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 12px;
            margin: 12px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .code-block code {
            color: #2c3e50;
            background: none;
            padding: 0;
        }

        /* Guide header */
        .guide-header {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            position: relative;
        }

        .guide-close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: #6c757d;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .guide-close-btn:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .guide-header h2 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.5rem;
        }

        .guide-header p {
            color: #6c757d;
            margin: 0;
        }

        /* Dark mode guide header styles */
        body[data-theme="dark"] .guide-header {
            border-bottom: 1px solid #333333;
        }

        body[data-theme="dark"] .guide-header h2 {
            color: #ffffff;
        }

        body[data-theme="dark"] .guide-header p {
            color: #d1d5db;
        }

        body[data-theme="dark"] .guide-close-btn {
            color: #ffffff;
        }

        body[data-theme="dark"] .guide-close-btn:hover {
            background: #333333;
            color: #ffffff;
        }

        /* Button styles */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #4a5568;
            color: white;
            border: 1px solid #718096;
        }

        .btn-primary:hover {
            background: #2d3748;
            border-color: #4a5568;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #2d3748;
            color: #e2e8f0;
            border: 1px solid #4a5568;
        }

        .btn-secondary:hover {
            background: #4a5568;
            border-color: #718096;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #00d4aa;
            color: white;
        }

        .btn-success:hover {
            background: #00b894;
            transform: translateY(-1px);
        }

        .btn-warning {
            background: #ffb800;
            color: white;
        }

        .btn-warning:hover {
            background: #e6a600;
            transform: translateY(-1px);
        }

        /* Desktop-only site - no mobile optimizations */

        .app-right-panel {
            position: relative;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .hero-banner {
                padding: 30px 15px;
                margin-bottom: 30px;
            }
            
            .hero-content h1 {
                font-size: 2rem;
            }
            
            .hero-content p {
                font-size: 1rem;
            }
            
            .hero-buttons {
                gap: 15px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-download {
                order: -1; /* Move download button to top on mobile */
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .platform-selector {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .theme-toggle {
                position: relative;
                top: auto;
                right: auto;
                margin: 20px auto;
            }

            .app-content {
                flex-direction: column;
            }

            .app-left-panel,
            .app-right-panel {
                width: 100%;
            }

            .app-left-panel {
                border-right: none;
                border-bottom: 1px solid #38383a;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <div class="header-content">
                <div class="header-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <img src="mtkclient/gui/images/icon.png" alt="Innioasis Updater" style="width: 115%; height: 115%; object-fit: contain;">
                </div>
                <div class="header-text">
                    <h1>Innioasis Updater</h1>
                    <p id="dynamic-subtitle">We've helped to update <span id="download-count">3,250+</span> Innioasis Y1s on Windows and Mac</p>
                </div>
            </div>
            <div class="header-download">
                <button onclick="showInstallGuide()" class="btn btn-primary header-download-btn">Get Started</button>
            </div>
        </div>

        <!-- Hero Banner Section -->
        <div class="hero-banner">
            <!-- Interactive Demo -->
            <div class="app-demo">
                <div class="app-window" id="app-window-demo">
                    <div class="app-content">
                        <div class="app-left-panel">
                            <div class="app-section">
                                <label>Device Type:</label>
                                <select class="app-select" id="device-type-select">
                                    <option value="A" selected>Type A</option>
                                    <option value="B">Type B</option>
                                </select>
                                <span class="app-icon" title="Help with device selection" onclick="showDeviceTypeDialog()">â“</span>
                                <button class="app-btn-small" onclick="openSettingsModal()">Settings</button>
                </div>
                            <div class="app-section">
                                <label>Device Model:</label>
                                <select class="app-select" id="device-model-select">
                                    <option value="Y1" selected>Y1</option>
                                </select>
                </div>
                            <div class="app-section">
                                <label>Software:</label>
                                <select class="app-select" id="software-select">
                                    <option value="Original Software" selected>Original Software</option>
                                    <option value="Rockbox ROM">Rockbox ROM</option>
                                </select>
                </div>
                            <div class="app-rom-list-header">
                                <span class="app-rom-list-title">Available Firmware</span>
                                <span class="app-rom-count" id="rom-count">0 versions</span>
                            </div>
                            <div class="app-rom-list" id="app-rom-list" role="listbox" aria-label="Available firmware versions">
                                <!-- ROM items will be populated by JavaScript -->
                            </div>
                            <div class="app-selection-status" id="selection-status" style="display: none;">
                                <span class="app-selection-label">Selected:</span>
                                <span class="app-selection-name" id="selected-firmware-name">None</span>
                            </div>
                            <button class="app-download-btn" id="download-btn" onclick="startInstallDemo()">Select Software to Try Demo</button>
                        </div>
                        <div class="app-right-panel">
                            <div class="app-header">
                                <span class="app-creator">Created by <a href="https://ko-fi.com/teamslide" target="_blank" class="app-creator-link">Ryan Specter of Team Slide</a></span>
                                <div class="app-action-buttons">
                                    <button class="app-action-btn green" onclick="showInstallZipModal()">ðŸ“¦ Install from .zip</button>
                                    <button class="app-action-btn red" onclick="window.open('https://reddit.com/r/innioasis', '_blank')">ðŸ”— r/innioasis</button>
                                    <button class="app-action-btn blue" onclick="scrollToUsersSection()">â“ Get Help</button>
                                    <button class="app-action-btn red" onclick="window.open('https://innioasis.app', '_blank')">ðŸ“° News / Tips</button>
                                </div>
                            </div>
                            <div class="app-status">
                                <strong>Status</strong>
                                <div id="status-text">Hey! Please unplug your Y1 from USB</div>
                                <!-- Progress Bar Container -->
                                <div class="app-progress-container" id="progress-container" style="display: none;">
                                    <div class="app-progress-text" id="progress-text">Downloading...</div>
                                    <div class="app-progress-bar">
                                        <div class="app-progress-fill" id="progress-fill"></div>
                                    </div>
                                    <div class="app-progress-text" id="progress-details">0% (0MB / 0MB)</div>
                                </div>
                            </div>
                            <div class="app-getting-ready" id="getting-ready-section">
                                <strong>Getting ready:</strong>
                                <div class="app-instruction-image">
                                    <img src="https://innioasis.app/mtkclient/gui/images/presteps.png" alt="Installation instructions" class="app-main-image">
                                </div>
                            </div>
                            <div class="app-labs">interactive app demo - sequences shortened for demonstration purposes, options may differ between operating systems.          </div>
            </div>
            
                        <!-- Settings Modal -->
                        <div class="app-modal-overlay" id="settings-modal" style="display: none;">
                            <div class="app-modal">
                                <div class="app-modal-header">
                                    <h3 class="app-modal-title">Settings</h3>
                                    <button class="app-modal-close" onclick="closeSettingsModal()">&times;</button>
                    </div>
                                <div class="app-modal-tabs">
                                    <button class="app-modal-tab active" onclick="switchSettingsTab('installation')">Installation</button>
                                    <button class="app-modal-tab" onclick="switchSettingsTab('tools')">Tools</button>
                    </div>
                                <div class="app-modal-content">
                                    <div class="app-modal-tab-content" id="installation-tab">
                                        <div class="app-modal-description">
                                            <h4>Installation Settings</h4>
                                            <p>This setting will be used for the next firmware installation.</p>
                    </div>
                                        <div class="app-modal-dropdown-group">
                                            <label for="install-method-select" class="app-modal-label">Installation Method:</label>
                                            <select id="install-method-select" class="app-modal-select">
                                                <option value="method1" selected>Method 1 - Guided (Step-by-step with visual guidance)</option>
                                                <option value="method2">Method 2 - MTKclient (Direct technical installation)</option>
                                            </select>
                </div>
                                        <div class="app-modal-checkbox-group">
                                            <label class="app-modal-checkbox">
                                                <input type="checkbox" id="always-use-method" checked>
                                                <span class="checkbox-custom"></span>
                                                Always use this method for future installations
                                            </label>
                                            <label class="app-modal-checkbox">
                                                <input type="checkbox" id="debug-mode">
                                                <span class="checkbox-custom"></span>
                                                Enable Debug Mode (Labs)
                                            </label>
            </div>
                                    </div>
                                    <div class="app-modal-tab-content" id="tools-tab" style="display: none;">
                                        <div class="app-modal-description">
                                            <h4>Developer Tools</h4>
                                            <p>Advanced tools for ROM developers and power users.</p>
                                        </div>
                                        <div class="app-modal-tools-section">
                                            <button class="app-modal-tool-btn app-modal-tool-btn-primary" onclick="launchY1RemoteControl()">
                                                ðŸŽ® Launch Y1 Remote Control
                                            </button>
                                            <button class="app-modal-tool-btn app-modal-tool-btn-secondary" onclick="checkForUtilityUpdates()">
                                                ðŸ”„ Check for Updates
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn app-modal-btn-primary" onclick="saveSettings()">Save Settings</button>
                                    <button class="app-modal-btn app-modal-btn-secondary" onclick="closeSettingsModal()">Cancel</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Install from ZIP Modal -->
                        <div class="app-modal-overlay" id="install-zip-modal" style="display: none;">
                            <div class="app-modal">
                                <div class="app-modal-header">
                                    <h3 class="app-modal-title">Install from .zip File</h3>
                                    <button class="app-modal-close" onclick="closeInstallZipModal()">&times;</button>
                                </div>
                                <div class="app-modal-content">
                                    <div class="app-modal-icon">ðŸ“¦</div>
                                    <p>You can install software packaged in <strong>rom.zip</strong> files using Innioasis Updater.</p>
                                    <p>Simply place your <code>rom.zip</code> file in the same directory as the Innioasis Updater application, and it will automatically detect and allow you to install it.</p>
                                    <div class="highlight">
                                        <strong>Supported formats:</strong>
                                        <ul>
                                            <li>SP Flash Tool compatible rom.zip files</li>
                                            <li>MTKClient compatible rom.zip files</li>
                                            <li>Custom ROM packages with proper structure</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn app-modal-btn-primary" onclick="closeInstallZipModal()">Got it</button>
                                </div>
                            </div>
                        </div>
            </div>
            <div class="app-disclaimer-outside">This is a scaled approximation of the interface, not an exact replica.</div>
            
            <div class="hero-content">
                <h1>Install Firmware Safely & Easily</h1>
                <p>Innioasis Updater makes it simple to install official firmware and custom ROMs on your Y1 device. No technical knowledge required.</p>
                <div class="hero-buttons">
                    <button onclick="showInstallGuide()" class="btn btn-secondary">Get Started</button>
                </div>
            </div>
        </div>

        <!-- Install Guide Modal -->
        <div class="modal-overlay" id="modalOverlay">
            <div class="modal-content">
                <div class="install-guide">
                    <!-- Header -->
                    <div class="guide-header">
                        <button class="guide-close-btn" onclick="closeInstallGuide()">Ã—</button>
                        <h2>ðŸš€ Innioasis Updater for Y1</h2>
                        <p>Windows, Mac and Linux compatible firmware installation - honestly, it's easier than you think!</p>
                    </div>

                    <!-- Platform Selector -->
                    <div class="platform-selector">
                        <div class="platform-card" data-platform="windows" onclick="selectInstallPlatform('windows')">
                            <span class="icon">ðŸªŸ</span>
                            <h3>Windows</h3>
                            <p>Works great on Windows 10 & 11</p>
                            <span class="status ready"></span>
                        </div>
                        
                        <div class="platform-card" data-platform="mac" onclick="selectInstallPlatform('mac')">
                            <span class="icon">ðŸŽ</span>
                            <h3>macOS</h3>
                            <p>Ventura and later</p>
                            <span class="status ready"></span>
                        </div>
                        
                        <div class="platform-card" data-platform="linux" onclick="selectInstallPlatform('linux')">
                            <span class="icon">ðŸ§</span>
                            <h3>Linux</h3>
                            <p>Ubuntu recommended</p>
                            <span class="status ready"></span>
                        </div>
                    </div>

                    <!-- Windows Installation Guide -->
                    <div class="installation-guide" id="windows-guide">
                        <div class="progress-bar">
                            <div class="progress-line">
                                <div class="fill" id="windows-progress"></div>
                            </div>
                            <div class="progress-step active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Drivers</div>
                            </div>
                            <div class="progress-step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Download</div>
                            </div>
                            <div class="progress-step" data-step="3">
                                <div class="step-number">3</div>
                                <div class="step-label">Install</div>
                            </div>
                        </div>

                        <!-- Step 1: Drivers -->
                        <div class="step" id="windows-step-1">
                            <h4>Step 1: Get the Right Drivers</h4>
                            <p>Your computer needs to know how to talk to your Y1. Complete these tasks:</p>
                            
                            <div class="checklist">
                                <div class="checklist-item">
                                    <div class="checklist-content">
                                         <h5>ðŸ“¥ MediaTek Driver (Required)</h5>
                                         <p>This is required for your computer to recognize your Y1 device on Windows</p>
                                        <div class="checklist-actions">
                                            <button class="btn btn-primary" onclick="downloadDriver('mtk')">Download MediaTek Driver</button>
                                            <button class="info-btn" onclick="showDriverInfo()" title="Important installation info">Help</button>
                                            <a href="#" onclick="markDriverComplete(); return false;" class="skip-link">Already done this</a>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item optional-item">
                                    <div class="checklist-content">
                                         <h5>ðŸ”§ USB Development Kit / UsbDk (Optional)</h5>
                                         <p>Enables MTKclient-based installation methods on Windows, allowing ROM developers to test cross-platform compatibility with Innioasis Updater.</p>
                                        <div class="checklist-actions">
                                            <button class="btn btn-secondary" onclick="downloadDriver('usb')">Download USB Dev Kit</button>
                                            <button class="info-btn" onclick="showUsbDevKitInfo()" title="USB Development Kit info">Help</button>
                                            <a href="#" onclick="markUsbDevKitComplete(); return false;" class="skip-link">Skip this step</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-success" onclick="nextWindowsStep()">Next: Download the App â†’</button>
                            </div>
                        </div>

                        <!-- Step 2: Download App -->
                        <div class="step" id="windows-step-2" style="display: none;">
                            <h4>Step 2: Download Innioasis Updater</h4>
                            <p>Now let's get the actual app that will handle your firmware updates:</p>
                            
                            <div class="download-section">
                                <h5>ðŸ“± Innioasis Updater for Windows</h5>
                                <p>This is the main app that will guide you through updating your Y1</p>
                                <button class="btn btn-primary" onclick="downloadWindows()">Download Windows Installer</button>
                            </div>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-secondary" onclick="prevWindowsStep()">â† Back to Drivers</button>
                                <button class="btn btn-success" onclick="nextWindowsStep()">Next: Installation â†’</button>
                            </div>
                        </div>

                        <!-- Step 3: Installation -->
                        <div class="step" id="windows-step-3" style="display: none;">
                            <h4>Step 3: Install Everything</h4>
                            <p>Almost there! Here's what to do next:</p>
                            
                            <ol>
                                <li>Install the MediaTek driver you downloaded</li>
                                <li>If you downloaded the USB Development Kit, install it as well</li>
                                <li>Install Innioasis Updater</li>
                                <li><strong>Restart your computer</strong> (this is important after installing drivers!)</li>
                                <li>Launch Innioasis Updater from the Start Menu</li>
                            </ol>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-secondary" onclick="prevWindowsStep()">â† Back to Download</button>
                                <button class="btn btn-success" onclick="closeInstallGuide()">Finish Setup</button>
                            </div>
                        </div>
                    </div>

                    <!-- macOS Installation Guide -->
                    <div class="installation-guide" id="mac-guide">
                        <div class="progress-bar">
                            <div class="progress-line">
                                <div class="fill" id="mac-progress"></div>
                            </div>
                            <div class="progress-step active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Homebrew</div>
                            </div>
                            <div class="progress-step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Download</div>
                            </div>
                            <div class="progress-step" data-step="3">
                                <div class="step-number">3</div>
                                <div class="step-label">Install</div>
                            </div>
                        </div>

                        <!-- Step 1: Homebrew -->
                        <div class="step" id="mac-step-1">
                            <h4>Step 1: Install Homebrew</h4>
                            <p>Homebrew is like a package manager that helps install all the pieces your Mac needs. Think of it as a helpful assistant that makes sure everything works together nicely.</p>
                            
                            <div class="download-section">
                                <h5>ðŸ“¥ Get Homebrew</h5>
                                <p>Click the button below to visit the Homebrew website and follow their straightforward installation guide:</p>
                                <button class="btn btn-primary" onclick="openHomebrew()">Visit Homebrew Website</button>
                            </div>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-success" onclick="nextMacStep()">Next: Download the App â†’</button>
                            </div>
                        </div>

                        <!-- Step 2: Download App -->
                        <div class="step" id="mac-step-2" style="display: none;">
                            <h4>Step 2: Download Innioasis Updater</h4>
                            <p>Now let's get the actual app. Click the button below and it'll start downloading to your Downloads folder:</p>
                            
                            <div class="download-section">
                                <h5>ðŸ“± Innioasis Updater for Mac</h5>
                                <p>This will download a .dmg file (disk image) to your Downloads folder</p>
                                <button class="btn btn-primary" onclick="downloadMac()">Download for Mac</button>
                            </div>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-secondary" onclick="prevMacStep()">â† Back to Homebrew</button>
                                <button class="btn btn-success" onclick="nextMacStep()">Next: Installation â†’</button>
                            </div>
                        </div>

                        <!-- Step 3: Installation -->
                        <div class="step" id="mac-step-3" style="display: none;">
                            <h4>Step 3: Install the App</h4>
                            <p>Now let's get the app installed on your Mac:</p>
                            
                            <ol>
                                <li>Double-click the downloaded .dmg file (it'll look like a disk image)</li>
                                <li>Drag the Innioasis Updater app to your Applications folder</li>
                                <li><strong>Restart your Mac</strong> (this is important after installing Homebrew and the app!)</li>
                                <li>Open it from your Applications folder</li>
                            </ol>
                            
                            <div class="download-section">
                                <h5>ðŸ”’ Security Settings</h5>
                                <p>You might need to tell your Mac it's okay to run this app. The exact steps depend on your macOS version:</p>
                                <button class="btn btn-warning" onclick="openMacSecurityGuide()">Open Security Guide</button>
                            </div>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button class="btn btn-secondary" onclick="prevMacStep()">â† Back to Download</button>
                                <button class="btn btn-success" onclick="closeInstallGuide()">Finish Setup</button>
                            </div>
                        </div>
                    </div>

                    <!-- Linux Installation Guide -->
                    <div class="installation-guide" id="linux-guide">
                        <h4>ðŸ§ Linux Installation</h4>
                        <p>Linux users, you're in luck! Ubuntu works best, but most other distributions should work too. We'll open a helpful guide that shows you exactly what to install.</p>
                        
                        <div class="download-section">
                            <h5>ðŸ“– Installation Guide</h5>
                            <p>Click the button below to open detailed Linux installation instructions:</p>
                            <button class="btn btn-primary" onclick="openLinuxGuide()">Open Linux Guide</button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 16px;">
                            <button class="btn btn-secondary" onclick="closeInstallGuide()">Close</button>
                        </div>
                    </div>
                </div>
                        
                        <!-- Device Type Dialog -->
                        <div class="app-modal-overlay" id="device-type-dialog" style="display: none;">
                            <div class="app-modal">
                                <div class="app-modal-header">
                                    <h3 class="app-modal-title">Device Type Selection Guide</h3>
                                    <button class="app-modal-close" onclick="closeDeviceTypeDialog()">&times;</button>
                                </div>
                                <div class="app-modal-content">
                                    <div class="app-modal-description">
                                        <h4>Device Type Selection Guide</h4>
                                        <p><strong>Type A Devices:</strong> This is the recommended starting point for most users. Install this first to see if it meets your needs.</p>
                                        <p><strong>Type B Devices:</strong> If your scroll wheel doesn't respond nicely after installing Type A, try one of the Type B options. These are alternative configurations that may fix scroll wheel issues.</p>
                                        <p><strong>Recommendation:</strong> Always start with Type A. Only move to Type B if you experience scroll wheel problems.</p>
                                    </div>
                                </div>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn app-modal-btn-primary" onclick="closeDeviceTypeDialog()">Got it</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Disconnect USB Modal -->
                        <div class="app-modal-overlay" id="disconnect-usb-modal" style="display: none;">
                            <div class="app-modal">
                                <div class="app-modal-header">
                                    <h3 class="app-modal-title">Disconnect USB</h3>
                                    <button class="app-modal-close" onclick="closeDisconnectUsbModal()">&times;</button>
                                </div>
                                <div class="app-modal-content">
                                    <div class="app-modal-icon" style="font-size: 48px; text-align: center; margin: 20px 0; color: #f59e0b;">âš ï¸</div>
                                    <div class="app-modal-description">
                                        <p style="font-size: 16px; line-height: 1.5; margin-bottom: 16px; text-align: center;">
                                            <strong>Hey! Please unplug the USB from your Y1 and press OK, then we'll guide you through the next steps.</strong>
                                        </p>
                                        <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px; margin: 16px 0;">
                                            <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">
                                                <strong>Important:</strong> Make sure the USB cable is completely disconnected from your Y1 device before continuing.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn app-modal-btn-primary" onclick="confirmDisconnectUsb()">OK, I've disconnected it</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Install Dialog -->
                        <div class="app-modal-overlay" id="install-dialog" style="display: none;">
                            <div class="app-modal">
                                <div class="app-modal-header">
                                    <h3 class="app-modal-title" id="dialog-title">Installation Dialog</h3>
                                    <button class="app-modal-close" onclick="closeInstallDialog()">&times;</button>
                                </div>
                                <div class="app-modal-content">
                                    <div class="app-dialog-icon" id="dialog-icon">âš ï¸</div>
                                    <p id="dialog-message">Please follow the instructions - we'll guide you through this!</p>
                                </div>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn app-modal-btn-secondary" onclick="cancelInstallDialog()">Cancel</button>
                                    <button class="app-modal-btn app-modal-btn-primary" onclick="confirmInstallDialog()">OK</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            
            <!-- Driver Info Modal -->
            <div class="info-modal" id="driverInfoModal">
                <div class="info-modal-content">
                    <button class="info-modal-close" onclick="closeDriverInfo()">Ã—</button>
                    <h3>ðŸ“¥ MediaTek Driver Installation Info</h3>
                    <p>When installing the MediaTek driver, you may see a dialog asking about removing the "origin driver". Here's what to do:</p>
                    
                    <div class="highlight">
                        <strong>Important:</strong> If the installer asks "Remove origin driver?", click <strong>Yes</strong>. This is totally normal and helps make sure the driver works nicely with your Y1 device.
                    </div>
                    
                    <p>This step is necessary because:</p>
                    <ul>
                        <li>It removes any conflicting drivers that might interfere</li>
                        <li>It ensures the MediaTek driver has full control over USB communication</li>
                        <li>It prevents driver conflicts that could cause connection issues</li>
                    </ul>
                    
                    <p>After installation, restart your computer as prompted to complete the setup.</p>
                </div>
            </div>

            <!-- USB Development Kit Info Modal -->
            <div class="info-modal" id="usbDevKitInfoModal">
                <div class="info-modal-content">
                    <button class="info-modal-close" onclick="closeUsbDevKitInfo()">Ã—</button>
                    <h3>ðŸ”§ USB Development Kit / UsbDk Info</h3>
                    <p>The USB Development Kit (UsbDk) is an optional driver that enables MTKclient-based installation methods on Windows.</p>
                    
                     <div class="highlight">
                         <strong>For ROM Developers:</strong> This allows Windows-based ROM developers to test if their ROMs are compatible with Innioasis Updater across platforms, not just on Windows.
                     </div>
                    
                    <p>Installing the USB Development Kit enables:</p>
                    <ul>
                        <li>MTKclient-based installation methods on Windows</li>
                        <li>Cross-platform ROM compatibility testing</li>
                        <li>Advanced debugging capabilities for ROM developers</li>
                    </ul>
                    
                    <p><strong>Most users can skip this step</strong> for a simpler experience. If you're not developing ROMs, you probably don't need this.</p>
                </div>
            </div>
        </div>

        <!-- Help & Support Section -->
        <div class="section-title">
            <h2>Help & Support</h2>
            <p>Get help with installation, development, or troubleshooting</p>
        </div>
        
        <!-- Mobile-specific message (hidden by default) -->
        <div class="mobile-only" style="display: none;">
            <div class="section-title">
                <h2>Visit from Your Computer</h2>
                <p>For the best experience, please visit <strong>innioasis.app</strong> from your computer to start your journey</p>
            </div>
        </div>
        
        <!-- Section Selector -->
        <div class="platform-selector">
            <div class="platform-card selected" data-platform="get-started" onclick="selectPlatform('get-started')">
                <span class="icon">ðŸš€</span>
                <h3>Install Innioasis Updater</h3>
                <p>Installation guide and setup</p>
                <span class="status"></span>
            </div>
            
            <div class="platform-card" data-platform="users" onclick="selectPlatform('users')">
                <span class="icon">ðŸ‘¥</span>
                <h3>Troubleshooting and Tips</h3>
                <p>Usage guide and common fixes</p>
                <span class="status"></span>
                </div>
                
            <div class="platform-card" data-platform="developers" onclick="selectPlatform('developers')">
                <span class="icon">ðŸ‘¨â€ðŸ’»</span>
                <h3>For Developers</h3>
                <p>Development resources and guidelines</p>
                <span class="status"></span>
                </div>
                
            <div class="platform-card" data-platform="rockbox" onclick="selectPlatform('rockbox')">
                <span class="icon">ðŸŽµ</span>
                <h3>Rockbox</h3>
                <p>Music player and themes guide</p>
                <span class="status"></span>
            </div>
                </div>
                
        <!-- Users Content -->
        <div class="content-section" id="users-content">
                <!-- Quick Start -->
                <div class="info-card">
                    <h3>ðŸš€ Quick Start</h3>
                    <p>Hey! Here's what you need to know to get started:</p>
                    <ol>
                        <li><strong>Install drivers first</strong> - The app will tell you which ones you need</li>
                        <li><strong>Restart your PC</strong> - This makes sure everything works nicely</li>
                        <li><strong>Disconnect your Y1</strong> - Keep it unplugged until the app tells you to connect it</li>
                        <li><strong>Follow the on-screen instructions</strong> - We'll guide you through each step</li>
                </ol>
                    <p>That's it! The app does the heavy lifting for you. ðŸ˜Š</p>
                </div>
                


                <!-- Troubleshooting -->
            <div class="info-card">
                    <h3>ðŸ”§ Troubleshooting</h3>
                    
                    <!-- Card 1: USB Timing (Most Important) -->
                    <div class="troubleshooting-card">
                        <h4>âš ï¸ USB Connection Timing</h4>
                        <p><strong>Before starting any update:</strong></p>
                        <ol>
                            <li>Unplug your Y1 completely - No USB cable connected at all</li>
                            <li>Wait for the app to tell you when to plug it in - Don't guess!</li>
                            <li>If it fails, unplug and try again - Same timing every time</li>
                        </ol>
                        <p><strong>Why it fails:</strong> Most problems happen because the Y1 gets connected too early. The app knows exactly when to connect it - trust us on this one!</p>
                    </div>
                    
                    <!-- Card 2: App frozen - Windows -->
                    <div class="troubleshooting-card platform-windows">
                        <h4>ðŸ”„ App frozen?</h4>
                        <p>Close it with Task Manager (Ctrl+Shift+Esc), then restart and click "Try Again"</p>
                    </div>
                    
                    <!-- Card 2: App frozen - Mac -->
                    <div class="troubleshooting-card platform-mac" style="display: none;">
                        <h4>ðŸ”„ App frozen?</h4>
                        <p>Force quit the app (Cmd+Option+Esc), then restart and click "Try Again"</p>
                    </div>
                    
                    <!-- Card 3: Check for utility updates (Universal) -->
                    <div class="troubleshooting-card">
                        <h4>ðŸ†• Try updating utilities first</h4>
                        <p>Most issues can be fixed by clicking "Check For Utility Updates" in the Settings dialog. This ensures you have the latest tools.</p>
                    </div>
                    
                    <!-- Card 4: Method selection (Universal) -->
                    <div class="troubleshooting-card">
                        <h4>âš™ï¸ Ensure Method 1 is selected</h4>
                        <p>Open Settings and make sure "Method 1" is selected. This is the most reliable installation method and fixes most compatibility issues.</p>
                    </div>
                    
                    <!-- Card 4b: Flash Tool Installation Error Fix - Windows -->
                    <div class="troubleshooting-card platform-windows">
                        <h4>ðŸ”§ Flash Tool Installation Error Fix</h4>
                        <p>Click "Check for Utility Updates" and set install method to Method 1. Unplug Y1 before trying again. If still failing, ensure MTK USB Driver is installed and USB Development Kit (UsbDk) is not installed.</p>
                    </div>
                    
                    <!-- Card 5: Missing shortcuts - Windows -->
                    <div class="troubleshooting-card platform-windows">
                        <h4>ðŸ”— Missing shortcuts?</h4>
                        <p>Run this in Command Prompt:</p>
                        <div class="code-block">"%LocalAppData%\Innioasis Updater\pythonw.exe" updater.py --force</div>
                    </div>
                    
                    <!-- Card 5: USB Driver - Windows -->
                    <div class="troubleshooting-card platform-windows">
                        <h4>ðŸ”Œ Can't install firmware?</h4>
                        <p>Make sure you have the MTK USB Driver installed - this is the only required Windows USB driver for both Method 1 and Method 2 (both now use SP Flash Tool)</p>
                    </div>
                    
                    <!-- Card 5: Mac-specific advice -->
                    <div class="troubleshooting-card platform-mac" style="display: none;">
                        <h4>ðŸŽ Mac-specific tips</h4>
                        <p>On Mac, most issues are resolved by using Method 1 and following the on-screen guidance. If you encounter permission issues, try running from Applications folder or check System Preferences â†’ Security & Privacy.</p>
                    </div>
                    
                    <!-- Card 5b: Mac app location -->
                    <div class="troubleshooting-card platform-mac" style="display: none;">
                        <h4>ðŸ“ Can't find the app?</h4>
                        <p>Make sure Innioasis Updater is in your Applications folder. If you're running it from Downloads or Desktop, it might not work properly. Drag it to Applications and try again.</p>
                    </div>
                    
                    <!-- Card 6: Complete reinstall (Universal) -->
                    <div class="troubleshooting-card">
                        <h4>ðŸ”„ Still having issues?</h4>
                        <p>If the above steps don't work, try uninstalling Innioasis Updater (or the older Y1 Helper) and reinstalling. This often resolves persistent problems.</p>
                    </div>
                    
                    <!-- Card 7: Manual firmware download (Universal) -->
                    <div class="troubleshooting-card">
                        <h4>ðŸ“¥ App won't work at all?</h4>
                        <p>Download firmwares from <a href="https://innioasis.app/firmware.html" target="_blank">innioasis.app/firmware.html</a> and use the troubleshooting shortcuts</p>
                    </div>
                    
                    <!-- Non-Windows Platform Message -->
                    <div class="troubleshooting-card platform-non-windows" style="display: none;">
                        <h4>ðŸ’» Troubleshooting for your platform</h4>
                        <p>These troubleshooting steps are specific to Windows. For Mac and Linux users, please refer to the installation guide or visit <a href="https://innioasis.app/firmware.html" target="_blank">innioasis.app/firmware.html</a> for platform-specific help.</p>
                    </div>
                        </div>
                        
            <!-- USB Driver Information -->
            <div class="info-card">
                <h3>ðŸ”Œ USB Driver Requirements</h3>
                <p><strong>Required Driver:</strong></p>
                <ul>
                    <li><strong>MTK USB Driver</strong> - Required for both Method 1 and Method 2 installation methods</li>
                </ul>
                <p><strong>Optional Driver:</strong></p>
                <ul>
                    <li><strong>USB Development Kit / UsbDk</strong> - Optional download from <a href="https://innioasis.app/driver_usbdk.msi" target="_blank">innioasis.app/driver_usbdk.msi</a></li>
                    <li><strong>Purpose:</strong> Enables MTKclient-based installation methods on Windows for cross-platform ROM testing</li>
                    <li><strong>Note:</strong> Only needed for ROM developers who want to test cross-platform compatibility</li>
                </ul>
                <div class="success-box">
                    <h4>ðŸ’¡ Driver Installation Tip</h4>
                    <p>For most users, just the MTK USB Driver is enough. The USB Development Kit / UsbDk is only needed for ROM developers who want to test cross-platform compatibility with Innioasis Updater.</p>
                        </div>
                    </div>


        <!-- Developers Content -->

                <!-- macOS Specific Issues -->
            <div class="info-card">
                    <h3>ðŸŽ macOS Specific Issues</h3>
                    <p><strong>App won't open?</strong> Right-click â†’ Open, or go to System Preferences â†’ Security & Privacy â†’ Allow</p>
                    <p><strong>Permission denied?</strong> Grant Terminal/App Store permissions when prompted</p>
                    <p><strong>USB not recognized?</strong> Try a different USB port or cable</p>
                    <p><strong>Homebrew issues?</strong> Run <code>brew update && brew upgrade</code> in Terminal</p>
                        </div>

                <!-- Remote Control for macOS -->
            <div class="info-card">
                    <h3>ðŸ“± Remote Control Features</h3>
                    <p>After your first update, you can:</p>
                    <ul>
                        <li><strong>Take screenshots</strong> of your Y1</li>
                        <li><strong>Control it remotely</strong> from your Mac</li>
                        <li><strong>Install apps</strong> without touching the device</li>
                </ul>
                    <p>Pretty neat, right? ðŸ˜Ž</p>
                    </div>
                </div>

            <!-- Linux Subsection -->
            <div class="sub-content-section" id="linux-sub-content">
                <h3 class="section-title">Linux Troubleshooting Guide</h3>
                
            <div class="info-card">
                    <h3>ðŸ§ Coming Soon</h3>
                    <p>We're working on Linux support! In the meantime:</p>
                    <ul>
                        <li>Check the main <a href="https://github.com/team-slide/Innioasis-Updater" target="_blank">GitHub repository</a> for Linux instructions</li>
                        <li>Ubuntu is recommended for the best experience</li>
                        <li>Most Linux distributions should work with manual setup</li>
                </ul>
                    <div class="warning-box">
                        <h4>âš ï¸ Work in Progress</h4>
                        <p>Linux support is actively being developed. Please check back soon!</p>
                        </div>
                        </div>
                        </div>
                    </div>

        <!-- Developers Content -->
        <div class="content-section" id="developers-content">
            <div class="container">
                <h2 class="section-title">For Developers - Technical Resources & Guidelines</h2>
            
            <!-- Development Overview -->
            <div class="info-card">
                <h3>ðŸ”§ Development Overview</h3>
                <p><strong>Innioasis Updater is built with Python and PyQt6, designed to be cross-platform and extensible.</strong></p>
                <p>The application provides a unified interface for firmware management, remote control capabilities, and app deployment for the Innioasis Y1 device. The architecture supports multiple installation methods (both now use SP Flash Tool) and provides a robust framework for developers to extend functionality.</p>
                <p><strong>Key Technical Components:</strong></p>
                <ul>
                    <li><strong>Core Engine:</strong> Python-based with PyQt6 GUI framework</li>
                    <li><strong>Installation Methods:</strong> SP Flash Tool integration (both Method 1 and Method 2 now use SP Flash Tool), user-friendly guidance for included utilities</li>
                    <li><strong>Remote Control:</strong> ADB-based device communication and control</li>
                    <li><strong>Firmware Management:</strong> Automated download, verification, and installation workflows</li>
                    <li><strong>Cross-Platform:</strong> Windows, macOS, and Linux support with platform-specific optimizations</li>
                </ul>
                
                <div class="info-box">
                    <h4>ðŸ”§ Flashing Protocol Clarification</h4>
                    <p><strong>Custom flashing protocols</strong> refers to user-friendly guidance for the included SP Flash Tool utility for interfacing with the Innioasis Y1's bootloader. Both Method 1 and Method 2 now use SP Flash Tool. These are not custom protocols we've created, but rather simplified interfaces to existing industry-standard flashing tools.</p>
                        </div>
                    </div>

            <!-- Y1 App Development -->
            <div class="info-card">
                <h3>ðŸ“± Y1 App Development Guidelines</h3>
                <p><strong>Target Platform Specifications:</strong></p>
                <ul>
                    <li><strong>Android Version:</strong> Android 4.2.2 (API Level 17)</li>
                    <li><strong>Architecture:</strong> ARM-based processor</li>
                    <li><strong>Display Resolutions:</strong> 240x320 (standard), 360p (high-res versions)</li>
                    <li><strong>Storage:</strong> Limited internal storage, external SD card support</li>
                </ul>
                <p><strong>Development Requirements:</strong></p>
                <ol>
                    <li><strong>Target API Level 17</strong> - Ensure compatibility with Android 4.2.2</li>
                    <li><strong>Optimize for small screens</strong> - Design for 240x320 and 360p resolutions</li>
                    <li><strong>Minimize resource usage</strong> - Limited RAM and storage on Y1</li>
                    <li><strong>Test on actual hardware</strong> - Emulator testing may not reflect real performance</li>
                </ol>
                <div class="success-box">
                    <h4>ðŸ“¦ App Distribution Process</h4>
                    <p><strong>To distribute your Y1 app:</strong></p>
                    <ol>
                        <li><strong>Release as APK on GitHub</strong> - Create a public repository with your APK</li>
                        <li><strong>Submit to Slidia</strong> - Add your app to the Team-Slide/Slidia manifest</li>
                        <li><strong>Include documentation</strong> - Provide installation and usage instructions</li>
                        <li><strong>Test thoroughly</strong> - Ensure compatibility with Y1 hardware</li>
                    </ol>
            </div>
                        </div>
                        
            <!-- ROM Development -->
            <div class="info-card">
                <h3>ðŸ’¾ Custom ROM Development</h3>
                <p><strong>Adding Custom ROMs to Innioasis Updater:</strong></p>
                <p>Developers can contribute custom ROMs that will be listed in the Innioasis Updater interface and firmware directory. This requires careful preparation and adherence to specific technical requirements.</p>
                <p><strong>ROM Package Requirements:</strong></p>
                <ul>
                    <li><strong>Create a rom.zip file</strong> containing all necessary flashable files</li>
                    <li><strong>Include SP Flash Tool compatible files</strong> - scatter.txt, preloader, lk, boot, system, etc.</li>
                    <li><strong>Include MTKClient compatible files</strong> - Must support all installation methods</li>
                    <li><strong>Provide comprehensive documentation</strong> - Installation instructions, features, compatibility notes</li>
                </ul>
                <p><strong>Repository Structure:</strong></p>
                <div class="code-block">
your-rom-repo/
â”œâ”€â”€ rom.zip                    # All flashable files
â”œâ”€â”€ README.md                  # Documentation
â”œâ”€â”€ changelog.txt             # Version history
â””â”€â”€ screenshots/              # Visual documentation
</div>
                <p><strong>Submission Process:</strong></p>
                <ol>
                    <li><strong>Create GitHub repository</strong> with your ROM files</li>
                    <li><strong>Test all installation methods</strong> - SP Flash Tool (Method 1 and 2) and Innioasis Updater</li>
                    <li><strong>Submit pull request</strong> to Team-Slide/Innioasis-Updater with repository details</li>
                    <li><strong>Specify ROM type</strong> - Type A or Type B (must use separate repositories)</li>
                    <li><strong>Include manifest entry</strong> - Provide the XML line for the firmware manifest</li>
                </ol>
                <div class="warning-box">
                    <h4>âš ï¸ Important Technical Notes</h4>
                    <p><strong>ROM Compatibility Requirements:</strong></p>
                    <ul>
                        <li><strong>Must support all installation methods</strong> - SP Flash Tool (Method 1 and 2) and Innioasis Updater</li>
                        <li><strong>Type A and Type B ROMs</strong> must be in separate repositories</li>
                        <li><strong>Include proper scatter files</strong> for SP Flash Tool compatibility</li>
                        <li><strong>Test on multiple Y1 devices</strong> to ensure compatibility</li>
                    </ul>
                        </div>
                    </div>

            <!-- Technical Architecture -->
            <div class="info-card">
                <h3>ðŸ—ï¸ Technical Architecture & Integration</h3>
                <p><strong>Innioasis Updater Architecture Overview:</strong></p>
                <p>The application is designed with modularity and extensibility in mind, allowing developers to easily integrate new features and support additional devices.</p>
                <p><strong>Core Components:</strong></p>
                <ul>
                    <li><strong>Firmware Manager:</strong> Handles download, verification, and installation of firmware packages</li>
                    <li><strong>Device Communication:</strong> ADB-based communication with Y1 devices for remote control and app deployment</li>
                    <li><strong>Installation Engine:</strong> Multi-method installation support (SP Flash Tool for both methods)</li>
                    <li><strong>UI Framework:</strong> PyQt6-based responsive interface with platform-specific optimizations</li>
                    <li><strong>Configuration System:</strong> JSON-based configuration management for user preferences and device settings</li>
                </ul>
                <p><strong>Integration Points for Developers:</strong></p>
                <ul>
                    <li><strong>Plugin System:</strong> Extensible architecture for adding new installation methods</li>
                    <li><strong>API Endpoints:</strong> RESTful API for firmware and app management</li>
                    <li><strong>Manifest System:</strong> XML-based manifest for firmware and app catalog management</li>
                    <li><strong>Remote Control SDK:</strong> Python SDK for developing Y1 remote control applications</li>
                </ul>
            </div>

            <!-- Development Resources -->
            <div class="info-card">
                <h3>ðŸ“š Development Resources & Documentation</h3>
                <p><strong>Essential Resources for Y1 Development:</strong></p>
                <ul>
                    <li><strong>GitHub Repository:</strong> <a href="https://github.com/team-slide/Innioasis-Updater" target="_blank">github.com/team-slide/Innioasis-Updater</a></li>
                    <li><strong>Firmware Directory:</strong> <a href="https://innioasis.app/firmware.html" target="_blank">innioasis.app/firmware.html</a></li>
                    <li><strong>Slidia Manifest:</strong> <a href="https://github.com/Team-Slide/Slidia" target="_blank">github.com/Team-Slide/Slidia</a></li>
                    <li><strong>Rockbox-y1 Reference:</strong> <a href="https://github.com/rockbox-y1/rockbox" target="_blank">github.com/rockbox-y1/rockbox</a></li>
                </ul>
                <p><strong>Development Tools:</strong></p>
                <ul>
                    <li><strong>Android Studio</strong> - For APK development with API Level 17 support</li>
                    <li><strong>MTKClient</strong> - For low-level device communication and testing</li>
                    <li><strong>SP Flash Tool</strong> - For ROM flashing and testing</li>
                    <li><strong>ADB Tools</strong> - For device communication and debugging</li>
                </ul>
                <div class="success-box">
                    <h4>ðŸ¤ Contributing Guidelines</h4>
                    <p><strong>How to Contribute:</strong></p>
                    <ol>
                        <li><strong>Fork the repository</strong> and create a feature branch</li>
                        <li><strong>Follow coding standards</strong> - Python PEP 8, proper documentation</li>
                        <li><strong>Test thoroughly</strong> - Ensure compatibility across all supported platforms</li>
                        <li><strong>Submit pull request</strong> with detailed description of changes</li>
                        <li><strong>Update documentation</strong> - Include any necessary documentation updates</li>
                        </ol>
                </div>
                </div>
            </div>
            </div>

        <!-- Rockbox Content -->
        <div class="content-section" id="rockbox-content">
            <div class="container">
                <h2 class="section-title">Rockbox Music Player & Themes</h2>
            
            <!-- Rockbox Overview -->
            <div class="info-card">
                <h3>ðŸŽµ What is Rockbox?</h3>
                <p>Rockbox is a powerful music player that modifies your Y1's Android system with Jo Falkner's Rockbox Android port. Install it directly from Innioasis Updater or <a href="https://innioasis.app/firmware.html" target="_blank">firmware directory</a>.</p>
                
                <p><strong>Key Features:</strong></p>
                <ul>
                    <li>Advanced audio codecs (FLAC, OGG, MP3, etc.)</li>
                    <li>Thousands of customizable themes</li>
                    <li>Gapless playback and crossfading</li>
                    <li>Plugin support for games and apps</li>
                </ul>
            </div>

            <!-- ROM Types -->
            <div class="info-card">
                <h3>ðŸ“± Choose Your ROM Type</h3>
                <ul>
                    <li><strong>âœ”ï¸ iPod Themes Compatible:</strong> Thousands of iPod Classic/Video themes available</li>
                    <li><strong>ðŸŸ  360p:</strong> High resolution display, fewer themes</li>
                    <li><strong>ðŸŒ™ Nightly:</strong> Latest features, may be unstable</li>
                </ul>
                <p><strong>Recommendation:</strong> Start with "iPod Themes Compatible" for maximum theme variety.</p>
            </div>

            <!-- Theme Installation -->
            <div class="info-card">
                <h3>ðŸŽ¨ Install Themes</h3>
                <ol>
                    <li>Download themes from <a href="https://themes.rockbox.org/" target="_blank">themes.rockbox.org</a></li>
                    <li>Connect Y1 via USB</li>
                    <li>Extract ZIP directly to Y1's root folder</li>
                    <li>Overwrite files when prompted</li>
                    <li>Select themes in Rockbox: Settings â†’ Theme â†’ Browse Themes</li>
                </ol>
            </div>

            <!-- Installation Warning -->
            <div class="warning-box">
                <h4>âš ï¸ Important</h4>
                <p>Rockbox modifies your Y1's Android system. Backup important data before installation - the process may affect your device's current setup.</p>
            </div>
            </div>
        </div>

        <div class="footer">
            <p>Created with â¤ï¸ by <a href="https://ko-fi.com/teamslide" target="_blank">Ryan Specter and Team Slide</a> | 
               <a href="https://reddit.com/r/innioasis" target="_blank">r/Innioasis</a> | 
               <a href="https://discord.gg/Timmkoo" target="_blank">Discord</a> | 
               <a href="https://innioasis.app" target="_blank">Add your Apps and Firmwares to Innioasis Updater</a></p>
        </div>
    </div>

    <script>
        // Global function to ensure scrolling is always restored
        function restoreScrolling() {
            document.body.style.overflow = '';
            document.body.style.overflowX = '';
            document.body.style.overflowY = '';
        }
        
        // Global function to disable scrolling (for modals)
        function disableScrolling() {
            document.body.style.overflow = 'hidden';
        }

        // Load screenshot fallback when simulator is hidden
        function loadScreenshotFallback() {
            const heroBanner = document.querySelector('.hero-banner');
            if (!heroBanner) return;

            const screenshotUrls = [
                'https://innioasis.app/mtkclient/gui/images/screenshot.jpg',
                'https://innioasis.app/mtkclient/gui/images/screenshot.png'
            ];

            let currentIndex = 0;

            function tryNextScreenshot() {
                if (currentIndex >= screenshotUrls.length) {
                    console.log('All screenshots failed to load, keeping current background');
                    return;
                }

                const url = screenshotUrls[currentIndex];
                console.log(`Attempting to load screenshot ${currentIndex + 1}/${screenshotUrls.length}: ${url}`);

                const img = new Image();
                let imageTimeout;

                img.onload = function() {
                    clearTimeout(imageTimeout);
                    console.log(`Successfully loaded screenshot: ${url}`);
                    
                    // Apply the screenshot as background with same styling as simulator
                    heroBanner.style.backgroundImage = `url('${url}')`;
                    heroBanner.style.backgroundSize = 'cover';
                    heroBanner.style.backgroundPosition = 'center center';
                    heroBanner.style.backgroundRepeat = 'no-repeat';
                    heroBanner.style.backgroundAttachment = 'scroll';
                    
                    // Override any existing background
                    heroBanner.style.background = `url('${url}') center center / cover no-repeat`;
                    
                    console.log('Screenshot applied to hero-banner:', url);
                };

                img.onerror = function() {
                    clearTimeout(imageTimeout);
                    console.warn(`Failed to load screenshot: ${url}`);
                    currentIndex++;
                    tryNextScreenshot();
                };

                // Set timeout for slow loading images
                imageTimeout = setTimeout(() => {
                    console.warn(`Timeout loading screenshot: ${url}`);
                    currentIndex++;
                    tryNextScreenshot();
                }, 5000);

                img.src = url;
            }

            tryNextScreenshot();
        }

        // Platform selection
        function selectPlatform(platform) {
            // Remove selection from all platform cards
            document.querySelectorAll('.platform-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select the clicked platform
            document.querySelector(`[data-platform="${platform}"]`).classList.add('selected');
            
            // Desktop-only site - no mobile detection needed
            
            // Handle special "get-started" case
            if (platform === 'get-started') {
                // Hide all content sections
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show the install guide modal
                showInstallGuide();
                return;
            }
            
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Desktop-only site - no mobile message handling needed
            
            // Show appropriate content for other platforms
            const contentSection = document.getElementById(`${platform}-content`);
            if (contentSection) {
                contentSection.classList.add('active');
                
                // Scroll to the content section for all users
                setTimeout(() => {
                    contentSection.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start',
                        inline: 'nearest'
                    });
                }, 100); // Small delay to ensure content is rendered
            }
            
            // If it's the users section, also select Windows by default
            if (platform === 'users') {
                selectSubPlatform('windows');
            }
        }

        // Sub-platform selection (for users section)
        function selectSubPlatform(subPlatform) {
            // Hide all sub-content sections
            document.querySelectorAll('.sub-content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove selection from all sub-platform cards
            document.querySelectorAll('[data-subplatform]').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select the clicked sub-platform
            document.querySelector(`[data-subplatform="${subPlatform}"]`).classList.add('selected');
            
            // Show appropriate sub-content
            document.getElementById(`${subPlatform}-sub-content`).classList.add('active');
        }

        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.querySelector('.theme-toggle');
            const icon = themeToggle.querySelector('.icon');
            const text = themeToggle.querySelector('span:not(.icon)');
            const currentTheme = localStorage.getItem('theme') || 'auto';
            
            let newTheme;
            if (currentTheme === 'auto') {
                newTheme = 'light';
            } else if (currentTheme === 'light') {
                newTheme = 'dark';
            } else {
                newTheme = 'auto';
            }
            
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        }

        // Apply the specified theme
        function applyTheme(theme) {
            const body = document.body;
            const themeToggle = document.querySelector('.theme-toggle');
            const icon = themeToggle.querySelector('.icon');
            const text = themeToggle.querySelector('span:not(.icon)');
            
            if (theme === 'auto') {
                // Check system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    body.setAttribute('data-theme', 'dark');
                    icon.textContent = 'ðŸŒ“';
                    text.textContent = 'Auto';
                } else {
                    body.removeAttribute('data-theme');
                    icon.textContent = 'ðŸŒ“';
                    text.textContent = 'Auto';
                }
            } else if (theme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                icon.textContent = 'â˜€ï¸';
                text.textContent = 'Light';
            } else {
                body.removeAttribute('data-theme');
                icon.textContent = 'ðŸŒ™';
                text.textContent = 'Dark';
            }
            
            // Reload screenshot when theme changes
            reloadScreenshot();
        }

        // Check saved theme preference and system theme
        function checkSavedTheme() {
            const savedTheme = localStorage.getItem('theme') || 'auto';
            applyTheme(savedTheme);
            
            // Listen for system theme changes when in auto mode
            if (savedTheme === 'auto') {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                    if (localStorage.getItem('theme') === 'auto') {
                        if (e.matches) {
                            document.body.setAttribute('data-theme', 'dark');
                        } else {
                            document.body.removeAttribute('data-theme');
                        }
                        // Reload screenshot when system theme changes
                        reloadScreenshot();
                    }
                });
            }
        }

        // Version parsing logic from firmware.html
        function parseVersionDesignations(versionName) {
            const designations = [];
            
            // Define adjectives that can modify their nearest neighbor
            const adjectives = ['compatible', 'aware', 'supported', 'enabled', 'disabled', 'ready', 'optimized', 'enhanced'];
            
            // Extract only the part after the last dash (this is the actual version number)
            // First remove long hex strings at the end (like -13057e75dc29a1a7!)
            let cleanVersion = versionName.replace(/-[a-f0-9]{16,}!?$/, '');
            // Remove any remaining trailing dashes or exclamation marks
            cleanVersion = cleanVersion.replace(/[-!]+$/, '');
            
            // Extract only the numbers after the last dash
            if (cleanVersion.includes('-')) {
                const lastPart = cleanVersion.split('-').pop();
                // Check if the last part contains only numbers (and possibly dots)
                if (/^[\d.]+$/.test(lastPart)) {
                    cleanVersion = lastPart;
                }
            }
            
            // Split the remaining parts
            const parts = cleanVersion.split('-');
            
            for (let i = 0; i < parts.length; i++) {
                const part = parts[i];
                
                // Skip if it's the version number part
                if (/^[\d.]+$/.test(part)) {
                    continue;
                }
                
                // Skip if it's a hex string
                if (/^[a-f0-9]{16,}!?$/.test(part)) {
                    continue;
                }
                
                // Check for iPod theme compatibility
                if (part.toLowerCase().includes('ipod') && i + 1 < parts.length) {
                    const nextPart = parts[i + 1];
                    if (nextPart.toLowerCase().includes('theme')) {
                        if (i + 2 < parts.length && adjectives.includes(parts[i + 2])) {
                            const adjective = parts[i + 2];
                            designations.push({
                                type: 'ipod-theme',
                                text: `iPod Themes ${adjective.charAt(0).toUpperCase() + adjective.slice(1)}`
                            });
                        } else {
                            designations.push({
                                type: 'ipod-theme',
                                text: 'iPod Themes'
                            });
                        }
                    }
                } else if (part.toLowerCase().includes('360p')) {
                    designations.push({
                        type: 'resolution',
                        text: '360p'
                    });
                } else if (part.toLowerCase().includes('nightly')) {
                    designations.push({
                        type: 'build-type',
                        text: 'Nightly'
                    });
                } else if (part.toLowerCase().includes('stable')) {
                    designations.push({
                        type: 'build-type',
                        text: 'Stable'
                    });
                } else if (!adjectives.includes(part)) {
                    // Just add the part as-is, capitalized
                    designations.push({
                        type: 'generic',
                        text: part.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
                    });
                }
            }
            
            return {
                version: cleanVersion,
                designations: designations
            };
        }

        function getDisplayVersion(versionInfo, publishedAt) {
            const date = new Date(publishedAt);
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayName = dayNames[date.getDay()];
            
            // For nightly builds, show day name
            if (versionInfo.designations.some(d => d.text === 'Nightly')) {
                return dayName;
            }
            
            // For stable releases, show version number
            return versionInfo.version;
        }

        // Real ROM data from firmware.html with parsed versions
        const realRomData = [
            {
                name: "Original Software",
                device_type: "A",
                device: "Y1",
                repo: "team-slide/y1-stock-rom",
                type: "img",
                releases: [
                    {
                        tag_name: "2.1.9",
                        name: "2.1.9",
                        published_at: "2024-07-15T00:00:00Z",
                        size: 154.8,
                        badges: ["Latest Release"]
                    },
                    {
                        tag_name: "2.1.7",
                        name: "2.1.7",
                        published_at: "2024-06-20T00:00:00Z",
                        size: 154.8,
                        badges: ["Previous Release"]
                        },
                        {
                            tag_name: "2.1.5",
                            name: "2.1.5",
                            published_at: "2024-05-15T00:00:00Z",
                            size: 154.2,
                            badges: ["Stable"]
                        },
                        {
                            tag_name: "2.1.3",
                            name: "2.1.3",
                            published_at: "2024-04-10T00:00:00Z",
                            size: 153.9,
                            badges: ["Legacy"]
                    }
                ]
            },
            {
                name: "Rockbox ROM",
                device_type: "A",
                device: "Y1",
                repo: "rockbox-y1/rockbox",
                type: "nightly",
                releases: [
                    {
                        tag_name: "2024-12-20-nightly-ipod-themes-compatible",
                        name: "Friday",
                        published_at: "2024-12-20T00:00:00Z",
                        size: 283.1,
                        badges: ["Nightly | âœ… iPod Themes Compatible"]
                    },
                    {
                        tag_name: "2024-12-20-nightly-360p",
                        name: "Friday",
                        published_at: "2024-12-20T00:00:00Z",
                        size: 285.7,
                        badges: ["Nightly | ðŸŸ  360p"]
                    },
                    {
                        tag_name: "2024-12-19-nightly-ipod-themes-compatible",
                        name: "Thursday",
                        published_at: "2024-12-19T00:00:00Z",
                        size: 282.8,
                        badges: ["Nightly | âœ… iPod Themes Compatible"]
                    },
                    {
                        tag_name: "2024-12-19-nightly-360p",
                        name: "Thursday",
                        published_at: "2024-12-19T00:00:00Z",
                        size: 284.3,
                        badges: ["Nightly | ðŸŸ  360p"]
                    },
                    {
                        tag_name: "2024-12-17-nightly-ipod-themes-compatible",
                        name: "Tuesday",
                        published_at: "2024-12-17T00:00:00Z",
                        size: 281.9,
                        badges: ["Nightly | âœ… iPod Themes Compatible"]
                    }
                ]
            },
            {
                name: "Original Software",
                device_type: "A",
                device: "Y1",
                repo: "team-slide/Innioasis-Updater",
                type: "stable",
                releases: [
                    {
                        tag_name: "2.1.9",
                        name: "2.1.9",
                        published_at: "2024-07-15T00:00:00Z",
                        size: 156.2,
                        badges: ["Stable Release"],
                        released: "Jul 2025"
                    },
                    {
                        tag_name: "2.1.7",
                        name: "2.1.7",
                        published_at: "2024-06-20T00:00:00Z",
                        size: 154.8,
                        badges: ["Previous Release"],
                        released: "Jun 2025"
                    }
                ]
            }
        ];

        // Placeholder ROM data for loading state
        const placeholderRomData = [
            {
                name: "Original Software",
                device_type: "A",
                device: "Y1",
                repo: "team-slide/y1-stock-rom",
                type: "img",
                releases: [
                    {
                        tag_name: "2.1.9",
                        name: "2.1.9",
                        published_at: "2024-07-15T00:00:00Z",
                        size: 154.8,
                        badges: ["Latest Release"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2.1.7",
                        name: "2.1.7",
                        published_at: "2024-06-20T00:00:00Z",
                        size: 154.8,
                        badges: ["Previous Release"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2.1.5",
                        name: "2.1.5",
                        published_at: "2024-05-15T00:00:00Z",
                        size: 154.2,
                        badges: ["Stable"],
                        isPlaceholder: true
                    }
                ]
            },
            {
                name: "Rockbox ROM",
                device_type: "A",
                device: "Y1",
                repo: "rockbox-y1/rockbox",
                type: "nightly",
                releases: [
                    {
                        tag_name: "2024-12-20-nightly-ipod-themes-compatible",
                        name: "Friday",
                        published_at: "2024-12-20T00:00:00Z",
                        size: 283.1,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-20-nightly-360p",
                        name: "Friday",
                        published_at: "2024-12-20T00:00:00Z",
                        size: 285.7,
                        badges: ["Nightly | ðŸŸ  360p"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-19-nightly-ipod-themes-compatible",
                        name: "Thursday",
                        published_at: "2024-12-19T00:00:00Z",
                        size: 282.8,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-19-nightly-360p",
                        name: "Thursday",
                        published_at: "2024-12-19T00:00:00Z",
                        size: 284.2,
                        badges: ["Nightly | ðŸŸ  360p"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-18-nightly-ipod-themes-compatible",
                        name: "Wednesday",
                        published_at: "2024-12-18T00:00:00Z",
                        size: 282.5,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-18-nightly-360p",
                        name: "Wednesday",
                        published_at: "2024-12-18T00:00:00Z",
                        size: 285.1,
                        badges: ["Nightly | ðŸŸ  360p"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-17-nightly-ipod-themes-compatible",
                        name: "Tuesday",
                        published_at: "2024-12-17T00:00:00Z",
                        size: 282.2,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-17-nightly-360p",
                        name: "Tuesday",
                        published_at: "2024-12-17T00:00:00Z",
                        size: 284.8,
                        badges: ["Nightly | ðŸŸ  360p"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-16-nightly-ipod-themes-compatible",
                        name: "Monday",
                        published_at: "2024-12-16T00:00:00Z",
                        size: 281.9,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-16-nightly-360p",
                        name: "Monday",
                        published_at: "2024-12-16T00:00:00Z",
                        size: 284.5,
                        badges: ["Nightly | ðŸŸ  360p"],
                        isPlaceholder: true
                    },
                    {
                        tag_name: "2024-12-15-nightly-ipod-themes-compatible",
                        name: "Sunday",
                        published_at: "2024-12-15T00:00:00Z",
                        size: 281.6,
                        badges: ["Nightly | âœ… iPod Themes Compatible"],
                        isPlaceholder: true
                    }
                ]
            },
            {
                name: "Custom ROM",
                device_type: "A",
                device: "Y1",
                repo: "team-slide/y1-custom-rom",
                type: "beta",
                releases: [
                    {
                        tag_name: "1.5.3",
                        name: "1.5.3",
                        published_at: "2024-12-18T00:00:00Z",
                        size: 165.2,
                        badges: ["Beta", "Latest"]
                    },
                    {
                        tag_name: "1.5.2",
                        name: "1.5.2",
                        published_at: "2024-12-10T00:00:00Z",
                        size: 164.8,
                        badges: ["Beta"]
                    },
                    {
                        tag_name: "1.5.1",
                        name: "1.5.1",
                        published_at: "2024-12-01T00:00:00Z",
                        size: 164.5,
                        badges: ["Beta"]
                    }
                ]
            },
            {
                name: "Original Software",
                device_type: "B",
                device: "Y1",
                repo: "team-slide/y1-stock-rom",
                type: "img",
                releases: [
                    {
                        tag_name: "2.2.1",
                        name: "2.2.1",
                        published_at: "2024-12-15T00:00:00Z",
                        size: 158.3,
                        badges: ["Latest Release", "Type B"]
                    },
                    {
                        tag_name: "2.2.0",
                        name: "2.2.0",
                        published_at: "2024-11-20T00:00:00Z",
                        size: 157.9,
                        badges: ["Stable", "Type B"]
                    }
                ]
            },
            {
                name: "Rockbox ROM",
                device_type: "B",
                device: "Y1",
                repo: "rockbox-y1/rockbox",
                type: "nightly",
                releases: [
                    {
                        tag_name: "2024-12-20-nightly-type-b",
                        name: "Friday (Type B)",
                        published_at: "2024-12-20T00:00:00Z",
                        size: 285.7,
                        badges: ["Nightly", "Type B"]
                    },
                    {
                        tag_name: "2024-12-19-nightly-type-b",
                        name: "Thursday (Type B)",
                        published_at: "2024-12-19T00:00:00Z",
                        size: 285.4,
                        badges: ["Nightly", "Type B"]
                    }
                ]
            },
            {
                name: "Minimal ROM",
                device_type: "A",
                device: "Y1",
                repo: "team-slide/y1-minimal-rom",
                type: "stable",
                releases: [
                    {
                        tag_name: "1.0.2",
                        name: "1.0.2",
                        published_at: "2024-12-12T00:00:00Z",
                        size: 89.4,
                        badges: ["Minimal", "Fast"]
                    },
                    {
                        tag_name: "1.0.1",
                        name: "1.0.1",
                        published_at: "2024-11-28T00:00:00Z",
                        size: 89.1,
                        badges: ["Minimal"]
                    }
                ]
            }
        ];

        // Version labeling logic - determines whether to show version or date
        function getDisplayName(release) {
            const tagName = release.tag_name || release.name || '';
            
            // Extract the part after the last hyphen separator
            const parts = tagName.split('-');
            const lastPart = parts[parts.length - 1];
            
            // If the last part is 8 characters or less, show the version
            if (lastPart && lastPart.length <= 8) {
                return lastPart;
            }
            
            // Otherwise, show the day name (date)
            const date = new Date(release.published_at || Date.now());
            return date.toLocaleDateString('en-US', { weekday: 'long' });
        }

        // Enhanced platform and version detection
        function detectPlatform() {
            const userAgent = navigator.userAgent.toLowerCase();
            if (userAgent.includes('mac')) return 'mac';
            if (userAgent.includes('win')) return 'windows';
            return 'mac'; // default to mac
        }
        
        function detectDetailedPlatform() {
            const userAgent = navigator.userAgent;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            
            if (isMobile) {
                return { platform: 'mobile', version: null };
            }
            
            if (userAgent.includes('Mac')) {
                return { platform: 'mac', version: 'tahoe' }; // Default to latest macOS
            }
            
            if (userAgent.includes('Linux')) {
                return { platform: 'linux', version: null };
            }
            
            if (userAgent.includes('Windows')) {
                // Try to detect Windows version
                if (userAgent.includes('Windows NT 10.0')) {
                    // Windows 10 or 11 - check build number if available
                    if (userAgent.includes('Edg/') && parseInt(userAgent.split('Edg/')[1]) >= 90) {
                        return { platform: 'windows', version: '11' }; // Likely Windows 11
                    }
                    return { platform: 'windows', version: '10' }; // Default to Windows 10
                }
                return { platform: 'windows', version: '10' }; // Fallback to Windows 10
            }
            
            return { platform: 'windows', version: '11' }; // Default fallback
        }
        
        function getWallpaperUrl(platformInfo) {
            const basePath = 'https://innioasis.app/mtkclient/gui/images/';
            
            // OS-appropriate screenshots with gradient fallbacks
            const screenshots = {
                windows: basePath + 'screenshot_win.jpg',
                mac: basePath + 'screenshot.png',
                linux: basePath + 'screenshot.png',
                mobile: basePath + 'screenshot.png',
                default: basePath + 'screenshot.png',
                // Gradient fallbacks
                gradientWindows: 'linear-gradient(135deg, #0078d4 0%, #106ebe 25%, #005a9e 50%, #004578 75%, #003d6b 100%)',
                gradientMac: 'linear-gradient(135deg, #1d1d1f 0%, #2d2d30 25%, #3a3a3c 50%, #48484a 75%, #5a5a5c 100%)',
                gradientBlue: 'linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #60a5fa 100%)',
                gradientPurple: 'linear-gradient(135deg, #581c87 0%, #7c3aed 50%, #a855f7 100%)'
            };
            
            // Return appropriate screenshots based on platform
            if (platformInfo.platform === 'windows') {
                return [screenshots.windows, screenshots.gradientWindows, screenshots.gradientBlue];
            } else if (platformInfo.platform === 'mac') {
                return [screenshots.mac, screenshots.gradientMac, screenshots.gradientPurple];
            } else if (platformInfo.platform === 'linux') {
                return [screenshots.linux, screenshots.gradientBlue, screenshots.gradientPurple];
            } else if (platformInfo.platform === 'mobile') {
                return [screenshots.mobile, screenshots.gradientBlue, screenshots.gradientPurple];
            }
            
            // Default fallback
            return [screenshots.default, screenshots.gradientBlue, screenshots.gradientPurple];
        }

        // Interactive Installation Demo
        function startInstallDemo() {
            if (isInstalling) return;
            
            isInstalling = true;
            installCurrentStep = 0; // Reset step counter
            const statusElement = document.getElementById('status-text');
            const gettingReadyElement = document.getElementById('getting-ready-section');
            const downloadBtn = document.getElementById('download-btn');
            
            if (!statusElement || !gettingReadyElement || !downloadBtn) return;
            
            // Disable the download button
            downloadBtn.disabled = true;
            downloadBtn.textContent = 'Downloading...';
            
            // Hide the left panel and expand the right panel during installation
            const leftPanel = document.querySelector('.app-left-panel');
            const rightPanel = document.querySelector('.app-right-panel');
            if (leftPanel && rightPanel) {
                leftPanel.classList.add('hidden');
                rightPanel.classList.add('expanded');
                // Also set inline styles as fallback
                leftPanel.style.display = 'none';
                rightPanel.style.width = '100%';
                rightPanel.style.minWidth = '100%';
                rightPanel.style.maxWidth = '100%';
            }
            
            // Get selected ROM data
            let selectedRelease;
            let romSize = 50; // Default size in MB
            
            if (realFirmwareData.length > 0) {
                // Use real data
                const deviceType = document.getElementById('device-type-select')?.value || 'A';
                const software = document.getElementById('software-select')?.value || 'Original Software';
                const filteredReleases = realFirmwareData.filter(release => {
                    const typeMatch = !deviceType || release.device_type === deviceType;
                    const softwareMatch = !software || release.software_name === software;
                    return typeMatch && softwareMatch;
                });
                
                selectedRelease = filteredReleases[currentSelectedRom] || filteredReleases[0];
                if (selectedRelease && selectedRelease.assets && selectedRelease.assets[0]) {
                    romSize = Math.round(selectedRelease.assets[0].size / (1024 * 1024)); // Convert bytes to MB
                }
            } else {
                // Fallback to mock data
                const deviceType = document.getElementById('device-type-select')?.value || 'A';
                const software = document.getElementById('software-select')?.value || 'Original Software';
                const mockRom = realRomData.find(rom => {
                    const typeMatch = !deviceType || rom.device_type === deviceType;
                    const softwareMatch = !software || rom.name === software;
                    return typeMatch && softwareMatch;
                });
                
                if (mockRom) {
                    selectedRelease = mockRom.releases[currentSelectedRom] || mockRom.releases[0];
                    romSize = selectedRelease.size;
                } else {
                    // Fallback to first available ROM
                    const fallbackRom = realRomData[0];
                    selectedRelease = fallbackRom.releases[currentSelectedRom] || fallbackRom.releases[0];
                    romSize = selectedRelease.size;
                }
            }
            const platform = detectPlatform();
            
            // Calculate download time at 1Gbps (125 MB/s)
            const downloadSpeed = 125; // MB/s
            const downloadTime = Math.ceil(romSize / downloadSpeed); // seconds
            
            // Get the correct image path based on platform and step
            function getImagePath(imageType) {
                if (imageType === 'initsteps') {
                    return platform === 'windows' ? 'https://innioasis.app/mtkclient/gui/images/initsteps_win.png' : 'https://innioasis.app/mtkclient/gui/images/initsteps.png';
                }
                return `https://innioasis.app/mtkclient/gui/images/${imageType}.png`;
            }

            // Get the correct initsteps image based on platform and method
            function getInitStepsImage() {
                if (platform === 'windows') {
                    return currentInstallMethod === 'method1' ? 'initsteps_sp' : 'initsteps_win';
                }
                return 'initsteps';
            }
            
            // Installation steps based on actual firmware_downloader.py process
            const releaseName = selectedRelease?.name || selectedRelease?.tag_name || 'Unknown Release';
            const installSteps = [
                { status: 'Downloading...', message: `Downloading ${releaseName}...`, delay: 500, image: 'presteps', showText: 'Starting download...', progress: 0 },
                { status: 'Downloading...', message: `Downloading... 25% (${(romSize * 0.25).toFixed(1)}MB / ${romSize}MB)`, delay: 300, image: 'presteps', showText: 'Downloading firmware...', progress: 25 },
                { status: 'Downloading...', message: `Downloading... 50% (${(romSize * 0.5).toFixed(1)}MB / ${romSize}MB)`, delay: 300, image: 'presteps', showText: 'Downloading firmware...', progress: 50 },
                { status: 'Downloading...', message: `Downloading... 75% (${(romSize * 0.75).toFixed(1)}MB / ${romSize}MB)`, delay: 300, image: 'presteps', showText: 'Downloading firmware...', progress: 75 },
                { status: 'Downloading...', message: `Downloading... 100% (${romSize}MB / ${romSize}MB) - Complete!`, delay: 200, image: 'presteps', showText: 'Download complete!', progress: 100 },
                { status: 'Processing...', message: 'Extracting rom.zip...', delay: 800, image: 'presteps', showText: 'Extracting firmware files...' },
                { status: 'Processing...', message: 'Verifying firmware integrity...', delay: 600, image: 'presteps', showText: 'Verifying firmware...' },
                { status: 'Dialog...', message: 'Hey! Please unplug your Y1 from USB', delay: 0, image: 'presteps', showText: 'Disconnect USB', dialog: { title: 'Disconnect USB', message: 'Hey! Please unplug the USB from your Y1 and press OK, then we\'ll guide you through the next steps.', icon: 'âš ï¸' } },
                { status: 'Preparing...', message: 'Follow the instructions below to prepare your Y1 for installation...', delay: Math.floor(Math.random() * 2000) + 3000, image: getInitStepsImage(), showText: 'Follow the instructions below to prepare your Y1 for installation...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Connecting to device...`, delay: 1500, image: 'installing', showText: 'Connecting to device...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Loading preloader...`, delay: 1200, image: 'installing', showText: 'Loading preloader...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Flashing boot partition...`, delay: 2000, image: 'installing', showText: 'Flashing boot partition...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Flashing system partition...`, delay: 2500, image: 'installing', showText: 'Flashing system partition...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Flashing recovery partition...`, delay: 1500, image: 'installing', showText: 'Flashing recovery partition...' },
                { status: 'Installing...', message: `${platform === 'windows' ? 'SP Flash Tool' : 'MTKClient'}: Finalizing installation...`, delay: 1200, image: 'installing', showText: 'Finalizing installation...' },
                { status: 'Completed!', message: 'Installation completed successfully!', delay: 3000, image: 'installed', showText: 'Installation completed successfully!', collapseLeft: true }
            ];
            
            
            function runNextStep() {
                if (installCurrentStep >= installSteps.length) {
                    // Installation complete - wait longer before reset
                    window.installTimeout = setTimeout(() => {
                        resetPanelLayout();
                        statusElement.textContent = 'Ready';
                        downloadBtn.disabled = false;
                        downloadBtn.textContent = 'Select Software to Try Demo';
                        isInstalling = false;
                        
                        // Hide progress bar
                        const progressContainer = document.getElementById('progress-container');
                        if (progressContainer) {
                            progressContainer.style.display = 'none';
                        }
                        
                        gettingReadyElement.innerHTML = `
                            <strong>Getting Ready:</strong>
                            <div class="app-instruction-image">
                                <img src="https://innioasis.app/mtkclient/gui/images/presteps.png" alt="Installation instructions" class="app-main-image">
                            </div>
                        `;
                    }, 4000); // Wait 4 seconds before reset
                    return;
                }
                
                const step = installSteps[installCurrentStep];
                
                // Handle dialog steps
                if (step.dialog) {
                    statusElement.textContent = step.message || step.status;
                    
                    // Check if this is the disconnect USB dialog
                    if (step.dialog.title === 'Disconnect USB') {
                        showDisconnectUsbModal();
                        
                        // Start proactive auto-dismiss timer even if modal doesn't show properly
                        console.log('Starting proactive disconnect USB auto-dismiss timer');
                        setTimeout(() => {
                            console.log('Proactive disconnect USB timeout - continuing installation');
                            if (window.continueInstallation) {
                                window.continueInstallation();
                            }
                        }, 1500);
                    } else {
                        // Use generic dialog for other cases
                        showInstallDialog(step.dialog.title, step.dialog.message, step.dialog.icon);
                    }
                    
                    // Set up continuation function
                    window.continueInstallation = () => {
                        installCurrentStep++;
                        runNextStep();
                    };
                    return;
                }
                
                statusElement.textContent = step.message || step.status;
                
                // Show/hide progress bar based on step
                const progressContainer = document.getElementById('progress-container');
                const progressFill = document.getElementById('progress-fill');
                const progressText = document.getElementById('progress-text');
                const progressDetails = document.getElementById('progress-details');
                
                if (step.progress !== undefined) {
                    // This is a download step - show progress bar
                    if (progressContainer) {
                        progressContainer.style.display = 'block';
                        progressFill.style.width = step.progress + '%';
                        progressText.textContent = step.status;
                        progressDetails.textContent = step.message;
                    }
                } else {
                    // Not a download or initsteps step - hide progress bar
                    if (progressContainer) {
                        progressContainer.style.display = 'none';
                    }
                }
                
                // Collapse left panel when installation starts
                if (step.collapseLeft) {
                    const leftPanel = document.querySelector('.app-left-panel');
                    const rightPanel = document.querySelector('.app-right-panel');
                    if (leftPanel && rightPanel) {
                        leftPanel.style.display = 'none';
                        rightPanel.style.width = '100%';
                    }
                }
                
                // Update the getting ready section with progress and proper image sequence
                const imagePath = getImagePath(step.image);
                const textFallback = step.showText || step.message;
                
                gettingReadyElement.innerHTML = `
                    <strong>${step.status === 'Completed!' ? 'Installation Complete!' : 'Getting Ready:'}</strong>
                    <div class="app-instruction-image">
                        <img src="${imagePath}" alt="${textFallback}" class="app-main-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div class="app-text-fallback" style="display: none; padding: 20px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                            <h4>${textFallback}</h4>
                            <p>${step.message}</p>
                        </div>
                    </div>
                `;
                
                installCurrentStep++;
                window.installTimeout = setTimeout(runNextStep, step.delay);
            }
            
            // Start the demo
            runNextStep();
        }

        // Enhanced app demo with interactive features
        let currentSelectedRom = 0;
        let currentInstallMethod = 'method1';
        let isInstalling = false;
        let installCurrentStep = 0;
        let apiTokens = [];
        let realFirmwareData = [];

        // Parse version designations (copied from firmware.html)
        function parseVersionDesignations(versionName) {
            const designations = [];
            
            // Define adjectives that can modify their nearest neighbor
            const adjectives = ['compatible', 'aware', 'supported', 'enabled', 'disabled', 'ready', 'optimized', 'enhanced'];
            
            // Extract only the part after the last dash (this is the actual version number)
            // First remove long hex strings at the end (like -13057e75dc29a1a7!)
            let cleanVersion = versionName.replace(/-[a-f0-9]{16,}!?$/, '');
            // Remove any remaining trailing dashes or exclamation marks
            cleanVersion = cleanVersion.replace(/[-!]+$/, '');
            
            // Extract only the numbers after the last dash
            if (cleanVersion.includes('-')) {
                const lastPart = cleanVersion.split('-').pop();
                // Check if the last part contains only numbers (and possibly dots)
                if (/^[\d.]+$/.test(lastPart)) {
                    cleanVersion = lastPart;
                }
            }
            
            // Parse designations from the original version name
            // Split by dashes and process each part
            const parts = versionName.split('-');
            
            for (let i = 0; i < parts.length; i++) {
                const part = parts[i];
                
                // Skip if it's the version number part
                if (/^[\d.]+$/.test(part)) {
                    continue;
                }
                
                // Skip if it's a hex string
                if (/^[a-f0-9]{16,}!?$/.test(part)) {
                    continue;
                }
                
                // Handle special cases first
                if (part === 'nightly') {
                    designations.push({
                        type: 'nightly',
                        text: 'Nightly'
                    });
                } else if (part === '360p') {
                    designations.push({
                        type: '360p',
                        text: '360p'
                    });
                } else if (part === 'wifi' || part === 'wi-fi') {
                    designations.push({
                        type: 'wifi',
                        text: 'Wi-Fi'
                    });
                } else if (part === 'bluetooth') {
                    designations.push({
                        type: 'bluetooth',
                        text: 'Bluetooth'
                    });
                } else if (part === 'usb') {
                    designations.push({
                        type: 'usb',
                        text: 'USB'
                    });
                } else if (part === 'ethernet') {
                    designations.push({
                        type: 'ethernet',
                        text: 'Ethernet'
                    });
                } else if (part === 'hdmi') {
                    designations.push({
                        type: 'hdmi',
                        text: 'HDMI'
                    });
                } else if (part === 'audio') {
                    designations.push({
                        type: 'audio',
                        text: 'Audio'
                    });
                } else if (part === 'video') {
                    designations.push({
                        type: 'video',
                        text: 'Video'
                    });
                } else if (part === 'camera') {
                    designations.push({
                        type: 'camera',
                        text: 'Camera'
                    });
                } else if (part === 'gps') {
                    designations.push({
                        type: 'gps',
                        text: 'GPS'
                    });
                } else if (part === 'nfc') {
                    designations.push({
                        type: 'nfc',
                        text: 'NFC'
                    });
                } else if (part === 'lte') {
                    designations.push({
                        type: 'lte',
                        text: 'LTE'
                    });
                } else if (part === '5g') {
                    designations.push({
                        type: '5g',
                        text: '5G'
                    });
                } else if (part === 'ipod-theme') {
                    // Check if this part is followed by an adjective
                    if (i + 2 < parts.length && adjectives.includes(parts[i + 2])) {
                        // Check for adjective after "ipod-theme"
                        const adjective = parts[i + 2];
                        designations.push({
                            type: 'ipod-theme',
                            text: `iPod Themes ${adjective.charAt(0).toUpperCase() + adjective.slice(1)}`
                        });
                    } else {
                        designations.push({
                            type: 'ipod-theme',
                            text: 'iPod Themes'
                        });
                    }
                } else {
                    // Check if this part is followed by an adjective
                    if (i + 1 < parts.length && adjectives.includes(parts[i + 1])) {
                        const adjective = parts[i + 1];
                        // Capitalize the main part and add the adjective
                        const mainPart = part.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                        designations.push({
                            type: 'generic',
                            text: `${mainPart} ${adjective.charAt(0).toUpperCase() + adjective.slice(1)}`
                        });
                    } else {
                        // Just add the part as-is, capitalized
                        if (!adjectives.includes(part)) { // Don't add standalone adjectives
                            designations.push({
                                type: 'generic',
                                text: part.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
                            });
                        }
                    }
                }
            }
            
            return designations;
        }

        // Enhanced API token loading from config.ini with better error handling
        async function loadApiTokens() {
            const configUrls = [
                'https://innioasis.app/config.ini',
                './config.ini',
                'config.ini'
            ];
            
            for (const url of configUrls) {
                try {
                    console.log(`Attempting to load API tokens from ${url}...`);
                    const response = await fetch(url);
                    if (!response.ok) {
                        console.warn(`Could not load config.ini from ${url} (${response.status})`);
                        continue;
                    }
                    
                    const configText = await response.text();
                    const tokens = [];
                    const lines = configText.split('\n');
                    
                    for (const line of lines) {
                        const trimmed = line.trim();
                        // Look for key_n = or token = patterns
                        if ((trimmed.match(/^key_\d+\s*=/) || trimmed.match(/^token\s*=/)) && trimmed.includes('=')) {
                            let token = trimmed.split('=')[1].trim();
                            // Remove quotes if present
                            token = token.replace(/^["']|["']$/g, '');
                            
                            if (token && token.length > 10) {
                                // Add github_pat_ prefix if token doesn't already have it
                                if (!token.startsWith('github_pat_') && !token.startsWith('ghp_')) {
                                    token = 'github_pat_' + token;
                                }
                                tokens.push(token);
                            }
                        }
                    }
                    
                    if (tokens.length > 0) {
                        console.log(`Successfully loaded ${tokens.length} API tokens from ${url}`);
                        return tokens;
                    } else {
                        console.warn(`No valid API tokens found in ${url}`);
                    }
                } catch (error) {
                    console.warn(`Error loading config.ini from ${url}:`, error);
                }
            }
            
            console.warn('Could not load API tokens from any source, using unauthenticated API calls only');
            return [];
        }
        
        // Centralized GitHub API request function with robust token handling
        async function makeGitHubAPIRequest(url, options = {}) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
            
            try {
                // First try unauthenticated request
                let response = await fetch(url, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'Innioasis-Updater/1.0',
                        ...options.headers
                    },
                    signal: controller.signal,
                    ...options
                });
                
                // If request failed and we have tokens, try with authentication
                if (!response.ok && apiTokens.length > 0) {
                    console.log(`Unauthenticated request failed (${response.status}), trying with authentication...`);
                    const randomToken = apiTokens[Math.floor(Math.random() * apiTokens.length)];
                    
                    response = await fetch(url, {
                        headers: {
                            'Authorization': `token ${randomToken}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'Innioasis-Updater/1.0',
                            ...options.headers
                        },
                        signal: controller.signal,
                        ...options
                    });
                    
                    console.log(`Authenticated request returned status: ${response.status}`);
                }
                
                clearTimeout(timeoutId);
                return response;
                
            } catch (error) {
                clearTimeout(timeoutId);
                throw error;
            }
        }

        // Fetch releases from GitHub API using centralized function
        async function fetchGitHubReleases(repo) {
            try {
                console.log(`Fetching releases for ${repo}...`);
                const response = await makeGitHubAPIRequest(`https://api.github.com/repos/${repo}/releases`);
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log(`Retrieved ${data.length} releases for ${repo}`);
                return data;
            } catch (error) {
                clearTimeout(timeoutId);
                if (error.name === 'AbortError') {
                    throw new Error(`Request timeout for ${repo}`);
                }
                throw error;
            }
        }

        // Load real firmware data from slidia manifest
        async function loadRealFirmwareData() {
            try {
                // Load slidia manifest
                const manifestResponse = await fetch('https://raw.githubusercontent.com/team-slide/slidia/refs/heads/main/slidia_manifest.xml');
                if (!manifestResponse.ok) {
                    throw new Error('Failed to load slidia manifest');
                }
                
                const manifestText = await manifestResponse.text();
                const packages = parseSlidiaManifest(manifestText);
                
                const allReleases = [];
                
                for (const pkg of packages) {
                    try {
                        const releases = await fetchGitHubReleases(pkg.repo);
                        console.log(`Fetched ${releases.length} releases from ${pkg.repo}`);
                        releases.forEach(release => {
                            // Only include releases that have rom.zip assets
                            const hasRomZip = release.assets && release.assets.some(asset => 
                                asset.name.toLowerCase().includes('rom.zip') || 
                                (asset.name.toLowerCase().includes('rom') && asset.name.toLowerCase().includes('.zip'))
                            );
                            
                            // Skip releases without rom.zip or with unwanted keywords
                            if (!hasRomZip || 
                                release.name.toLowerCase().includes('voice') ||
                                release.name.toLowerCase().includes('voices') ||
                                release.name.toLowerCase().includes('theme') ||
                                release.name.toLowerCase().includes('themes') ||
                                release.name.toLowerCase().includes('font') ||
                                release.name.toLowerCase().includes('fonts') ||
                                release.name.toLowerCase().includes('sound') ||
                                release.name.toLowerCase().includes('sounds') ||
                                release.tag_name.toLowerCase().includes('voice') ||
                                release.tag_name.toLowerCase().includes('voices') ||
                                release.tag_name.toLowerCase().includes('theme') ||
                                release.tag_name.toLowerCase().includes('themes') ||
                                release.tag_name.toLowerCase().includes('font') ||
                                release.tag_name.toLowerCase().includes('fonts') ||
                                release.tag_name.toLowerCase().includes('sound') ||
                                release.tag_name.toLowerCase().includes('sounds')) {
                                return;
                            }
                            
                            const releaseData = {
                                ...release,
                                software_name: pkg.name,
                                device_type: pkg.device_type,
                                device_model: pkg.device,
                                type: pkg.type,
                                handler: pkg.handler
                            };
                            allReleases.push(releaseData);
                        });
                    } catch (error) {
                        console.warn(`Failed to load releases for ${pkg.repo}:`, error);
                    }
                }
                
                console.log(`Loaded ${allReleases.length} real releases from GitHub`);
                return allReleases;
            } catch (error) {
                console.error('Error loading real firmware data:', error);
                return [];
            }
        }

        // Parse slidia manifest XML
        function parseSlidiaManifest(xmlText) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
            const packageElements = xmlDoc.querySelectorAll('package');
            
            const packages = [];
            for (let pkg of packageElements) {
                packages.push({
                    name: pkg.getAttribute('name') || 'Unknown',
                    device_type: pkg.getAttribute('device_type') || '',
                    repo: pkg.getAttribute('repo') || '',
                    device: pkg.getAttribute('device') || '',
                    url: pkg.getAttribute('url') || '',
                    type: pkg.getAttribute('type') || '',
                    handler: pkg.getAttribute('handler') || ''
                });
            }
            
            return packages;
        }

        function initializeAppDemo() {
            const platform = detectPlatform();
            const appWindow = document.getElementById('app-window-demo');
            
            if (appWindow) {
                appWindow.className = `app-window ${platform}`;
            }
            
            // Set initial selection
            currentSelectedRom = 0;
            
            // Immediately populate with placeholder data
            console.log('Initializing with placeholder data...');
            console.log('placeholderRomData length:', placeholderRomData.length);
            console.log('realRomData length:', realRomData.length);
            updateRomList();
            
            // Load API tokens and real data
            console.log('Initializing app demo with API token fallback...');
            loadApiTokens().then(tokens => {
                apiTokens = tokens;
                console.log(`API tokens loaded: ${tokens.length} tokens available`);
                if (tokens.length > 0) {
                    console.log('Sample token format:', tokens[0].substring(0, 20) + '...');
                }
                return loadRealFirmwareData();
            }).then(data => {
                realFirmwareData = data;
                console.log(`Real firmware data loaded: ${data.length} releases`);
                updateRomList(); // Update with real data
            }).catch(error => {
                console.error('Error initializing app demo:', error);
                console.log('Falling back to mock data for firmware listing');
                // Ensure we have some data even if everything fails
                realFirmwareData = [];
                updateRomList(); // Fallback to mock data
            });
            
            // Add event listeners for interactive features
            setupInteractiveFeatures();
            
            // Show/hide Windows-only settings based on platform
            const windowsOnlySection = document.getElementById('windows-only-section');
            if (windowsOnlySection) {
                windowsOnlySection.style.display = platform === 'windows' ? 'block' : 'none';
            }
            
            // Show/hide troubleshooting cards based on platform
            const windowsCards = document.querySelectorAll('.platform-windows');
            const macCards = document.querySelectorAll('.platform-mac');
            const nonWindowsCards = document.querySelectorAll('.platform-non-windows');
            
            if (platform === 'windows') {
                // Show Windows-specific troubleshooting cards
                windowsCards.forEach(card => {
                    card.style.display = 'block';
                });
                // Hide Mac-specific cards
                macCards.forEach(card => {
                    card.style.display = 'none';
                });
                // Hide non-Windows message
                nonWindowsCards.forEach(card => {
                    card.style.display = 'none';
                });
            } else {
                // Hide Windows-specific troubleshooting cards
                windowsCards.forEach(card => {
                    card.style.display = 'none';
                });
                // Show Mac-specific cards
                macCards.forEach(card => {
                    card.style.display = 'block';
                });
                // Show non-Windows message
                nonWindowsCards.forEach(card => {
                    card.style.display = 'block';
                });
            }
            
            // Initialize modals - ensure they're properly hidden by default
            const modals = ['device-type-dialog', 'install-dialog', 'install-zip-modal', 'disconnect-usb-modal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'none';
                }
            });
        }

        function updateRomList() {
            const romList = document.getElementById('app-rom-list');
            if (!romList) {
                console.log('ROM list element not found');
                return;
            }
            
            // Get current filter values
            const deviceType = document.getElementById('device-type-select')?.value || 'A';
            const software = document.getElementById('software-select')?.value || 'Original Software';
            
            console.log('Updating ROM list with filters:', { deviceType, software });
            
            // Filter releases based on current selections
            let filteredReleases = [];
            
            if (realFirmwareData && realFirmwareData.length > 0) {
                // Use real data from GitHub
                filteredReleases = realFirmwareData.filter(release => {
                    const typeMatch = !deviceType || release.device_type === deviceType;
                    const softwareMatch = !software || release.software_name === software;
                    return typeMatch && softwareMatch;
                }).slice(0, 10); // Limit to 10 most recent
            }
            
            // If no real data or no matches, use placeholder data
            if (filteredReleases.length === 0) {
                console.log('Using placeholder data for firmware listing');
                console.log('Current filters:', { deviceType, software });
                console.log('Available placeholder ROMs:', placeholderRomData.map(r => ({ name: r.name, device_type: r.device_type })));
                
                // Try to find exact match first
                let placeholderRom = placeholderRomData.find(rom => {
                    const typeMatch = !deviceType || rom.device_type === deviceType;
                    const softwareMatch = !software || rom.name === software;
                    console.log('Checking ROM:', rom.name, 'device_type:', rom.device_type, 'typeMatch:', typeMatch, 'softwareMatch:', softwareMatch);
                    return typeMatch && softwareMatch;
                });
                
                // If no exact match, try with realRomData
                if (!placeholderRom) {
                    console.log('No exact match in placeholder data, trying realRomData');
                    placeholderRom = realRomData.find(rom => {
                        const typeMatch = !deviceType || rom.device_type === deviceType;
                        const softwareMatch = !software || rom.name === software;
                        console.log('Checking real ROM:', rom.name, 'device_type:', rom.device_type, 'typeMatch:', typeMatch, 'softwareMatch:', softwareMatch);
                        return typeMatch && softwareMatch;
                    });
                }
                
                // If still no match, use the first available ROM
                if (!placeholderRom) {
                    console.log('No exact match found, using first available ROM');
                    placeholderRom = placeholderRomData[0] || realRomData[0];
                    if (placeholderRom) {
                        console.log('Using fallback ROM:', placeholderRom.name);
                    } else {
                        console.error('No ROMs available in placeholder or real data!');
                    }
                }
                
                if (placeholderRom) {
                    console.log('Using ROM:', placeholderRom.name, 'with', placeholderRom.releases.length, 'releases');
                    filteredReleases = placeholderRom.releases.map((release, index) => ({
                        ...release,
                        software_name: placeholderRom.name,
                        device_type: placeholderRom.device_type,
                        device_model: placeholderRom.device
                    }));
                } else {
                    console.log('No ROMs available at all!');
                }
            }
            
            romList.innerHTML = '';
            
            // Ensure minimum listings are always available
            if (software === 'Original Software' && filteredReleases.length < 1) {
                console.log('Ensuring minimum Original Software listings');
                const fallbackOriginal = [
                    {
                        tag_name: "2.1.9",
                        name: "2.1.9",
                        published_at: "2024-07-15T00:00:00Z",
                        size: 154.8,
                        badges: ["Latest Release"],
                        software_name: "Original Software",
                        device_type: deviceType || "A",
                        device_model: "Y1",
                        isFallback: true
                    }
                ];
                filteredReleases.push(...fallbackOriginal);
            }
            
            if (software === 'Rockbox ROM' && filteredReleases.length < 10) {
                console.log('Ensuring minimum Rockbox ROM nightly listings');
                const fallbackRockbox = [];
                const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                const baseDate = new Date('2024-12-15');
                
                for (let i = 0; i < 10; i++) {
                    const date = new Date(baseDate);
                    date.setDate(date.getDate() + i);
                    const dayName = days[date.getDay()];
                    const dateStr = date.toISOString().split('T')[0];
                    
                    // Add both iPod Themes Compatible and 360p versions
                    if (i < 5) {
                        fallbackRockbox.push({
                            tag_name: `${dateStr}-nightly-ipod-themes-compatible`,
                            name: dayName,
                            published_at: date.toISOString(),
                            size: 282.5 + (i * 0.5),
                            badges: ["Nightly | âœ… iPod Themes Compatible"],
                            software_name: "Rockbox ROM",
                            device_type: deviceType || "A",
                            device_model: "Y1",
                            isFallback: true
                        });
                    } else {
                        fallbackRockbox.push({
                            tag_name: `${dateStr}-nightly-360p`,
                            name: dayName,
                            published_at: date.toISOString(),
                            size: 284.5 + ((i-5) * 0.5),
                            badges: ["Nightly | ðŸŸ  360p"],
                            software_name: "Rockbox ROM",
                            device_type: deviceType || "A",
                            device_model: "Y1",
                            isFallback: true
                        });
                    }
                }
                filteredReleases.push(...fallbackRockbox);
            }
            
            if (filteredReleases.length === 0) {
                // Final fallback - create basic firmware items
                console.log('No filtered releases found, creating basic fallback ROMs');
                console.log('Available data sources:', {
                    realFirmwareData: realFirmwareData.length,
                    placeholderRomData: placeholderRomData.length,
                    realRomData: realRomData.length
                });
                const fallbackReleases = [
                    {
                        tag_name: "2.1.9",
                        name: "2.1.9",
                        published_at: "2024-07-15T00:00:00Z",
                        size: 154.8,
                        badges: ["Latest Release"],
                        software_name: software || "Original Software",
                        device_type: deviceType || "A",
                        device_model: "Y1"
                    },
                    {
                        tag_name: "2.1.7",
                        name: "2.1.7",
                        published_at: "2024-06-20T00:00:00Z",
                        size: 154.8,
                        badges: ["Previous Release"],
                        software_name: software || "Original Software",
                        device_type: deviceType || "A",
                        device_model: "Y1"
                    }
                ];
                
                filteredReleases.push(...fallbackReleases);
                console.log('Created', filteredReleases.length, 'fallback releases');
            }
            
            console.log('Rendering', filteredReleases.length, 'ROMs');
            filteredReleases.forEach((release, index) => {
                const romItem = document.createElement('div');
                romItem.className = `app-rom-item ${index === currentSelectedRom ? 'selected' : ''}`;
                romItem.onclick = () => selectRom(index);
                romItem.setAttribute('tabindex', '0');
                romItem.setAttribute('role', 'option');
                romItem.setAttribute('aria-selected', index === currentSelectedRom);
                
                // Use badges from mock data if available, otherwise parse designations
                let badges = '';
                if (release.badges && release.badges.length > 0) {
                    badges = release.badges.join(' | ');
            } else {
                    // Parse version designations for real data
                    const designations = parseVersionDesignations(release.tag_name || release.name);
                    badges = designations.map(d => {
                        let text = d.text;
                        // Add emojis based on designation type
                        if (d.type === 'ipod-theme') {
                            text = `âœ… ${text}`;
                        } else if (d.type === '360p') {
                            text = `ðŸŸ  ${text}`;
                        } else if (d.type === 'nightly') {
                            text = `ðŸŒ™ ${text}`;
                        } else if (d.type === 'stable') {
                            text = `â­ ${text}`;
                        }
                        return text;
                    }).join(' | ');
                }
                
                // Use new version labeling logic
                const displayName = getDisplayName(release);
                
                romItem.innerHTML = `
                    <div class="app-rom-selection-indicator"></div>
                    <div class="app-rom-content">
                    <span class="app-rom-day">${displayName}</span>
                    <span class="app-rom-info">Software: ${release.software_name || 'Unknown'}</span>
                    <span class="app-rom-badge">${badges || 'Release'}</span>
                    </div>
                `;
                
                romList.appendChild(romItem);
            });
            
            // Update download button text based on firmware selection
            const downloadBtn = document.getElementById('download-btn');
            if (downloadBtn) {
                if (filteredReleases.length > 0 && currentSelectedRom >= 0 && currentSelectedRom < filteredReleases.length) {
                    // Firmware is selected - show download option
                    const selectedRelease = filteredReleases[currentSelectedRom];
                    const softwareName = selectedRelease.software_name || 'Software';
                    
                    if (softwareName.toLowerCase().includes('original')) {
                        downloadBtn.textContent = 'Download (Update/Restore)';
                } else {
                    downloadBtn.textContent = 'Download';
                }
                } else {
                    // No firmware selected - show demo prompt
                    downloadBtn.textContent = 'Select Software to Try Demo';
                }
            }

            // Update selection status
            updateSelectionStatus(filteredReleases);
            
            // Update firmware count
            updateFirmwareCount(filteredReleases.length);
        }

        function updateSelectionStatus(filteredReleases) {
            const selectionStatus = document.getElementById('selection-status');
            const selectedFirmwareName = document.getElementById('selected-firmware-name');
            const downloadBtn = document.getElementById('download-btn');
            
            if (selectionStatus && selectedFirmwareName) {
                if (filteredReleases.length > 0 && currentSelectedRom >= 0 && currentSelectedRom < filteredReleases.length) {
                    const selectedRelease = filteredReleases[currentSelectedRom];
                    const displayName = getDisplayName(selectedRelease);
                    selectedFirmwareName.textContent = displayName;
                    selectionStatus.style.display = 'flex';
                    
                    // Update button text when firmware is selected
                    if (downloadBtn) {
                        const softwareName = selectedRelease.software_name || 'Software';
                        if (softwareName.toLowerCase().includes('original')) {
                            downloadBtn.textContent = 'Download (Update/Restore)';
                        } else {
                            downloadBtn.textContent = 'Download';
                        }
                    }
                } else {
                    selectionStatus.style.display = 'none';
                    
                    // Reset button text when no firmware is selected
                    if (downloadBtn) {
                        downloadBtn.textContent = 'Select Software to Try Demo';
                    }
                }
            }
        }

        function updateFirmwareCount(count) {
            const romCount = document.getElementById('rom-count');
            if (romCount) {
                romCount.textContent = `${count} version${count !== 1 ? 's' : ''}`;
            }
        }

        function selectRom(index) {
            // Add selection animation
            const romList = document.getElementById('app-rom-list');
            if (romList && romList.children[index]) {
                const selectedItem = romList.children[index];
                selectedItem.classList.add('selecting');
                
                // Remove animation class after animation completes
                setTimeout(() => {
                    selectedItem.classList.remove('selecting');
                }, 300);
            }
            
            currentSelectedRom = index;
            updateRomList();
            
            // Update aria-selected attributes for accessibility
            if (romList) {
                Array.from(romList.children).forEach((item, i) => {
                    item.setAttribute('aria-selected', i === index);
                });
            }
        }

        function setupInteractiveFeatures() {
            // Add event listeners for dropdowns
            const deviceTypeSelect = document.getElementById('device-type-select');
            const softwareSelect = document.getElementById('software-select');
            
            if (deviceTypeSelect) {
                deviceTypeSelect.addEventListener('change', () => {
                    currentSelectedRom = 0; // Reset selection
                    updateRomList();
                });
            }
            
            if (softwareSelect) {
                softwareSelect.addEventListener('change', () => {
                    currentSelectedRom = 0; // Reset selection
                    updateRomList();
                });
            }

            // Add keyboard navigation support
            document.addEventListener('keydown', (e) => {
                const romList = document.getElementById('app-rom-list');
                if (!romList || romList.children.length === 0) return;

                const romItems = Array.from(romList.children);
                const maxIndex = romItems.length - 1;

                switch(e.key) {
                    case 'ArrowUp':
                        e.preventDefault();
                        if (currentSelectedRom > 0) {
                            selectRom(currentSelectedRom - 1);
                        }
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        if (currentSelectedRom < maxIndex) {
                            selectRom(currentSelectedRom + 1);
                        }
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (currentSelectedRom >= 0 && currentSelectedRom <= maxIndex) {
                            startInstallDemo();
                        }
                        break;
                }
            });

            // Add focus management for better accessibility
            const romList = document.getElementById('app-rom-list');
            if (romList) {
                romList.setAttribute('tabindex', '0');
                romList.addEventListener('focus', () => {
                    if (currentSelectedRom === -1 && romList.children.length > 0) {
                        selectRom(0);
                    }
                });
            }
        }

        // Universal auto-dismiss functionality for modals
        let modalTimeouts = {};
        let modalActivityTrackers = {};
        
        function setupAutoDismiss(modalId, timeoutMs = 5000, excludeInstallGuide = true) {
            // Don't auto-dismiss install guide modals
            if (excludeInstallGuide && modalId.includes('modalOverlay')) {
                return;
            }
            
            let lastActivity = Date.now();
            
            const checkAndDismiss = () => {
                const timeSinceActivity = Date.now() - lastActivity;
                if (timeSinceActivity >= timeoutMs) {
                    console.log(`Auto-dismissing ${modalId} after ${timeoutMs}ms of inactivity`);
                    
                    // Check if modal exists and handle appropriately
                    const modal = document.getElementById(modalId);
                    if (modal) {
                        if (modal.style.display === 'flex' || modal.style.display === 'block') {
                            // Modal is visible, close normally
                            closeModal(modalId);
                        } else {
                            // Modal exists but isn't visible - might be a spawning issue
                            console.warn(`Modal ${modalId} exists but isn't visible - attempting to show and then dismiss`);
                            modal.style.display = 'flex';
                            updateModalScaling(getCurrentScaleFactor());
                            setTimeout(() => closeModal(modalId), 100); // Brief flash to show it existed
                        }
                    } else {
                        console.warn(`Modal ${modalId} doesn't exist in DOM`);
                    }
                    
                    // Handle special case for disconnect USB to continue installation
                    if (modalId === 'disconnect-usb-modal') {
                        if (window.continueInstallation) {
                            window.continueInstallation();
                        }
                    }
                } else {
                    // Check again after remaining time
                    const remainingTime = timeoutMs - timeSinceActivity;
                    modalTimeouts[modalId] = setTimeout(checkAndDismiss, remainingTime);
                }
            };
            
            // Set up initial timeout
            modalTimeouts[modalId] = setTimeout(checkAndDismiss, timeoutMs);
            
            // Track user activity across the entire page
            const activityEvents = ['mousedown', 'mousemove', 'keydown', 'scroll', 'touchstart'];
            const updateActivity = () => {
                lastActivity = Date.now();
            };
            
            activityEvents.forEach(event => {
                document.addEventListener(event, updateActivity, { passive: true });
            });
            
            // Store cleanup function
            modalActivityTrackers[modalId] = () => {
                activityEvents.forEach(event => {
                    document.removeEventListener(event, updateActivity);
                });
            };
        }
        
        // Helper function to get current scale factor
        function getCurrentScaleFactor() {
            const appDemo = document.querySelector('.app-demo');
            if (appDemo) {
                const currentTransform = appDemo.style.transform;
                const currentZoom = appDemo.style.zoom;
                
                if (currentTransform && currentTransform.includes('scale')) {
                    const match = currentTransform.match(/scale\(([\d.]+)\)/);
                    if (match) return parseFloat(match[1]);
                } else if (currentZoom && currentZoom !== '1' && currentZoom !== '') {
                    return parseFloat(currentZoom);
                }
            }
            return 1;
        }
        
        function cleanupAutoDismiss(modalId) {
            // Clear timeout
            if (modalTimeouts[modalId]) {
                clearTimeout(modalTimeouts[modalId]);
                delete modalTimeouts[modalId];
            }
            
            // Clean up activity listeners
            if (modalActivityTrackers[modalId]) {
                modalActivityTrackers[modalId]();
                delete modalActivityTrackers[modalId];
            }
        }

        // Standardized modal opening function
        function openModal(modalId, initCallback = null) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
                
                // Apply current scaling to the modal
                const appDemo = document.querySelector('.app-demo');
                if (appDemo) {
                    const currentTransform = appDemo.style.transform;
                    const currentZoom = appDemo.style.zoom;
                    let scaleFactor = 1;
                    
                    if (currentTransform && currentTransform.includes('scale')) {
                        const match = currentTransform.match(/scale\(([\d.]+)\)/);
                        if (match) scaleFactor = parseFloat(match[1]);
                    } else if (currentZoom && currentZoom !== '1' && currentZoom !== '') {
                        scaleFactor = parseFloat(currentZoom);
                    }
                    
                    updateModalScaling(scaleFactor);
                }
                
                // Add click-outside-to-close functionality
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        closeModal(modalId);
                    }
                };
                
                // Set up auto-dismiss for simulator modals (5 seconds)
                setupAutoDismiss(modalId, 5000);
                
                // Run any modal-specific initialization
                if (initCallback) {
                    initCallback();
                }
            }
        }
        
        // Standardized modal closing function
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                modal.onclick = null; // Remove event listener
                
                // Clean up auto-dismiss functionality
                cleanupAutoDismiss(modalId);
            }
        }

        function openSettingsModal() {
            openModal('settings-modal', () => {
                // Ensure only installation tab is visible when opening
                switchSettingsTab('installation');
                
                // Initialize dropdown with current method
                const methodSelect = document.getElementById('install-method-select');
                if (methodSelect) {
                    methodSelect.value = currentInstallMethod;
                }
            });
        }

        function closeSettingsModal() {
            closeModal('settings-modal');
        }

        // Installation Dialog Functions
        function showInstallDialog(title, message, icon = 'âš ï¸') {
            const dialogTitle = document.getElementById('dialog-title');
            const dialogMessage = document.getElementById('dialog-message');
            const dialogIcon = document.getElementById('dialog-icon');
            
            if (dialogTitle && dialogMessage && dialogIcon) {
                dialogTitle.textContent = title;
                dialogMessage.textContent = message;
                dialogIcon.textContent = icon;
            }
            
            openModal('install-dialog');
        }

        function closeInstallDialog() {
            closeModal('install-dialog');
        }

        function confirmInstallDialog() {
            closeInstallDialog();
            // Continue with installation
            if (window.continueInstallation) {
                window.continueInstallation();
            }
        }

        function cancelInstallDialog() {
            closeInstallDialog();
            // Reset installation to initial state
            resetInstallation();
        }

        function resetInstallation() {
            // Reset all installation state
            installCurrentStep = 0;
            const statusElement = document.getElementById('status-text');
            const progressContainer = document.getElementById('progress-container');
            const progressFill = document.getElementById('progress-fill');
            const gettingReadyElement = document.getElementById('getting-ready');
            
            if (statusElement) {
                statusElement.textContent = 'Hey! Please unplug your Y1 from USB';
            }
            
            if (progressContainer) {
                progressContainer.style.display = 'none';
            }
            
            if (progressFill) {
                progressFill.style.width = '0%';
            }
            
            if (gettingReadyElement) {
                gettingReadyElement.innerHTML = '<strong>Ready to install:</strong><br>Select a ROM and click Download to begin.';
            }
            
            // Clear any pending timeouts
            if (window.installTimeout) {
                clearTimeout(window.installTimeout);
                window.installTimeout = null;
            }
            
            // Reset the download button
            const downloadBtn = document.getElementById('download-btn');
            if (downloadBtn) {
                downloadBtn.textContent = 'Select Software to Try Demo';
                downloadBtn.disabled = false;
            }
            
            console.log('Installation reset to initial state');
        }

        // Install from ZIP Modal Functions
        function showInstallZipModal() {
            openModal('install-zip-modal');
        }

        function closeInstallZipModal() {
            closeModal('install-zip-modal');
        }

        // Scroll to Users Section
        function scrollToUsersSection() {
            // First, switch to the users platform
            selectPlatform('users');
            
            // Then scroll to the Quick Start section specifically
            const quickStartCard = document.querySelector('#users-content .info-card h3');
            if (quickStartCard && quickStartCard.textContent.includes('Quick Start')) {
                quickStartCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                // Fallback to users content if Quick Start not found
                const usersContent = document.getElementById('users-content');
                if (usersContent) {
                    usersContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
        }

        function showDeviceTypeDialog() {
            openModal('device-type-dialog');
        }

        function closeDeviceTypeDialog() {
            closeModal('device-type-dialog');
        }
        
        // Disconnect USB Modal Functions with auto-dismiss failsafe
        function showDisconnectUsbModal() {
            // Clean up any existing auto-dismiss for this modal first
            cleanupAutoDismiss('disconnect-usb-modal');
            
            openModal('disconnect-usb-modal');
            
            // Override default 5-second auto-dismiss with 1.5-second for disconnect USB
            setupAutoDismiss('disconnect-usb-modal', 1500, false);
        }
        
        function closeDisconnectUsbModal() {
            closeModal('disconnect-usb-modal');
        }
        
        function confirmDisconnectUsb() {
            closeDisconnectUsbModal();
            // Continue with installation
            if (window.continueInstallation) {
                window.continueInstallation();
            }
        }

        function saveSettings() {
            const methodSelect = document.getElementById('install-method-select');
            
            if (methodSelect) {
                currentInstallMethod = methodSelect.value;
            }
            
            closeSettingsModal();
        }

        function launchY1RemoteControl() {
            alert('Y1 Remote Control would launch here. This is a simulation.');
        }

        function checkForUtilityUpdates() {
            alert('Checking for utility updates... This is a simulation.');
        }

        function switchSettingsTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.app-modal-tab-content');
            tabContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.app-modal-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.style.display = 'block';
            }
            
            // Add active class to the correct tab button
            const activeTab = document.querySelector(`[onclick="switchSettingsTab('${tabName}')"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
        }

        function expandRightPanel() {
            const appWindow = document.getElementById('app-window-demo');
            const leftPanel = document.getElementById('app-left-panel');
            const rightPanel = document.getElementById('app-right-panel');
            
            if (appWindow && leftPanel && rightPanel) {
                appWindow.classList.add('installation-mode');
                leftPanel.classList.add('hidden');
                rightPanel.classList.add('expanded');
            }
        }

        function resetPanelLayout() {
            const appWindow = document.getElementById('app-window-demo');
            const leftPanel = document.querySelector('.app-left-panel');
            const rightPanel = document.querySelector('.app-right-panel');
            
            if (appWindow && leftPanel && rightPanel) {
                appWindow.classList.remove('installation-mode');
                
                // Reset left panel
                leftPanel.classList.remove('hidden');
                leftPanel.style.display = 'flex';
                
                // Reset right panel
                rightPanel.classList.remove('expanded');
                rightPanel.style.width = '840px';
                rightPanel.style.minWidth = '840px';
                rightPanel.style.maxWidth = '840px';
                rightPanel.style.flex = '0 0 auto';
            }
        }


        // Install Guide Modal Functions
        let currentPlatform = null;
        let currentStep = 1;

        // Show install guide modal
        function showInstallGuide() {
            const modal = document.getElementById('modalOverlay');
            if (modal) {
                // Ensure modal is visible and centered
                modal.style.display = 'flex';
                modal.style.position = 'fixed';
                modal.style.top = '0';
                modal.style.left = '0';
                modal.style.width = '100vw';
                modal.style.height = '100vh';
                modal.classList.add('show');
                
                // Force a reflow to ensure visibility
                modal.offsetHeight;
                
                // Scroll to the modal
                setTimeout(() => {
                    modal.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start',
                        inline: 'nearest'
                    });
                }, 100);
                
                // Add click-outside-to-close functionality
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        closeInstallGuide();
                    }
                };
                
                // Auto-detect OS and select appropriate platform
                const userAgent = navigator.userAgent;
                let platform = 'windows'; // default
                
                if (userAgent.includes('Mac')) {
                    platform = 'mac';
                } else if (userAgent.includes('Linux')) {
                    platform = 'linux';
                }
                
                // Automatically select the detected platform
                setTimeout(() => {
                    selectPlatform(platform);
                }, 100); // Small delay to ensure modal is fully rendered
            }
        }

        // Close install guide modal
        function closeInstallGuide() {
            const modal = document.getElementById('modalOverlay');
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                
                // Remove click-outside-to-close functionality
                modal.onclick = null;
            }
            
            // Reset platform selection
            document.querySelectorAll('.platform-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.querySelectorAll('.installation-guide').forEach(guide => {
                guide.classList.remove('show');
            });
            
            currentPlatform = null;
            currentStep = 1;
        }

        // Platform selection for install guide
        function selectInstallPlatform(platform) {
            // Hide all guides
            document.querySelectorAll('.installation-guide').forEach(guide => {
                guide.classList.remove('show');
            });
            
            // Remove selection from all platform cards
            document.querySelectorAll('.platform-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select the clicked platform
            const selectedCard = document.querySelector(`[data-platform="${platform}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            // Show the corresponding guide
            const guide = document.getElementById(`${platform}-guide`);
            if (guide) {
                guide.classList.add('show');
            }
            
            currentPlatform = platform;
            currentStep = 1;
            updateProgressBar(platform, 1);
        }

        // Update progress bar
        function updateProgressBar(platform, step) {
            const progressFill = document.getElementById(`${platform}-progress`);
            if (progressFill) {
                const percentage = ((step - 1) / 2) * 100;
                progressFill.style.width = `${percentage}%`;
            }
            
            // Update step indicators
            const steps = document.querySelectorAll(`#${platform}-guide .progress-step`);
            steps.forEach((stepEl, index) => {
                const stepNum = index + 1;
                if (stepNum < step) {
                    stepEl.classList.add('completed');
                    stepEl.classList.remove('active');
                } else if (stepNum === step) {
                    stepEl.classList.remove('completed');
                    stepEl.classList.add('active');
                } else {
                    stepEl.classList.remove('active', 'completed');
                }
            });
        }

        // Windows step navigation
        function nextWindowsStep() {
            if (currentStep < 3) {
                currentStep++;
                document.getElementById(`windows-step-${currentStep - 1}`).style.display = 'none';
                document.getElementById(`windows-step-${currentStep}`).style.display = 'block';
                updateProgressBar('windows', currentStep);
            }
        }

        function prevWindowsStep() {
            if (currentStep > 1) {
                currentStep--;
                document.getElementById(`windows-step-${currentStep + 1}`).style.display = 'none';
                document.getElementById(`windows-step-${currentStep}`).style.display = 'block';
                updateProgressBar('windows', currentStep);
            }
        }

        // Mac step navigation
        function nextMacStep() {
            if (currentStep < 3) {
                currentStep++;
                document.getElementById(`mac-step-${currentStep - 1}`).style.display = 'none';
                document.getElementById(`mac-step-${currentStep}`).style.display = 'block';
                updateProgressBar('mac', currentStep);
            }
        }

        function prevMacStep() {
            if (currentStep > 1) {
                currentStep--;
                document.getElementById(`mac-step-${currentStep + 1}`).style.display = 'none';
                document.getElementById(`mac-step-${currentStep}`).style.display = 'block';
                updateProgressBar('mac', currentStep);
            }
        }


        // Download functions
        function downloadDriver(driverType) {
            if (driverType === 'mtk') {
                const url = 'https://innioasis.app/assets/driver_mtk.exe';
                const filename = 'driver_mtk.exe';
                
                // For Safari, open in new tab, for other browsers use download attribute
                if (navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {
                    window.open(url, '_blank');
                    setTimeout(() => {
                        alert(`ðŸŽ‰ Opening MediaTek driver download page in new tab! Click the download button on the GitHub page.`);
                    }, 1000);
                } else {
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    setTimeout(() => {
                        alert(`ðŸŽ‰ MediaTek driver download started! Check your Downloads folder.`);
                    }, 1000);
                }
            } else if (driverType === 'usb') {
                const url = 'https://innioasis.app/driver_usbdk.msi';
                const filename = 'driver_usbdk.msi';
                
                if (navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {
                    window.open(url, '_blank');
                    setTimeout(() => {
                        alert(`ðŸŽ‰ Opening USB Development Kit download page in new tab! Click the download button on the GitHub page.`);
                    }, 1000);
                } else {
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    setTimeout(() => {
                        alert(`ðŸŽ‰ USB Development Kit download started! Check your Downloads folder.`);
                    }, 1000);
                }
            }
        }

        function downloadWindows() {
            const url = 'https://github.com/team-slide/Innioasis-Updater/releases/latest/download/Innioasis.Updater.-.Windows.exe';
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Innioasis.Updater.-.Windows.exe';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            setTimeout(() => {
                alert('ðŸŽ‰ Download started! The Windows installer is downloading to your Downloads folder.');
            }, 1000);
            
            // Auto-advance to next step after a short delay
            setTimeout(() => {
                nextWindowsStep();
            }, 1500);
        }

        function downloadMac() {
            const url = 'https://github.com/team-slide/Innioasis-Updater/releases/latest/download/Innioasis.Updater.for.Mac.dmg';
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Innioasis.Updater.for.Mac.dmg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            setTimeout(() => {
                alert('ðŸŽ‰ Download started! The Mac installer is downloading to your Downloads folder.');
            }, 1000);
            
            // Auto-advance to next step after a short delay
            setTimeout(() => {
                nextMacStep();
            }, 1500);
        }


        function openHomebrew() {
            window.open('https://brew.sh/', '_blank');
        }

        function openMacSecurityGuide() {
            window.open('https://support.apple.com/guide/mac-help/open-a-mac-app-from-an-unidentified-developer-mh40616/mac', '_blank');
        }

        function openLinuxGuide() {
            window.open('https://github.com/team-slide/Innioasis-Updater#linux---ubuntu-recommended', '_blank');
        }


        // Mark steps as complete
        function markDriverComplete() {
            const checklistItems = document.querySelectorAll('.checklist-item');
            if (checklistItems.length > 0) {
                const driverItem = checklistItems[0]; // First checklist item
                driverItem.style.opacity = '0.6';
                driverItem.style.textDecoration = 'line-through';
                driverItem.querySelector('.checklist-actions').innerHTML = '<span class="completed-text">âœ“ Completed</span>';
            }
        }

        function markUsbDevKitComplete() {
            const checklistItems = document.querySelectorAll('.checklist-item');
            if (checklistItems.length > 1) {
                const usbDevKitItem = checklistItems[1]; // Second checklist item
                usbDevKitItem.style.opacity = '0.6';
                usbDevKitItem.style.textDecoration = 'line-through';
                usbDevKitItem.querySelector('.checklist-actions').innerHTML = '<span class="completed-text">âœ“ Completed</span>';
            }
        }

        // Info modals
        function showDriverInfo() {
            const modal = document.getElementById('driverInfoModal');
            if (modal) {
                // Force immediate visibility
                modal.style.display = 'flex';
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                // Add click-outside-to-close functionality
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        closeDriverInfo();
                    }
                };
                
                // Force a repaint to ensure the modal appears immediately
                modal.offsetHeight;
                
                console.log('Driver info modal should now be visible');
            }
        }

        function closeDriverInfo() {
            const modal = document.getElementById('driverInfoModal');
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                document.body.style.overflow = '';
                
                // Remove click-outside-to-close functionality
                modal.onclick = null;
            }
        }

        function showUsbDevKitInfo() {
            const modal = document.getElementById('usbDevKitInfoModal');
            if (modal) {
                // Force immediate visibility
                modal.style.display = 'flex';
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                // Add click-outside-to-close functionality
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        closeUsbDevKitInfo();
                    }
                };
                
                // Force a repaint to ensure the modal appears immediately
                modal.offsetHeight;
                
                console.log('USB DevKit info modal should now be visible');
            }
        }

        function closeUsbDevKitInfo() {
            const modal = document.getElementById('usbDevKitInfoModal');
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                document.body.style.overflow = '';
                
                // Remove click-outside-to-close functionality
                modal.onclick = null;
            }
        }

        // Mobile-first responsive design
        function updateSimulatorScale() {
            const appDemo = document.querySelector('.app-demo');
            const appWindow = document.querySelector('.app-window');
            if (!appDemo || !appWindow) return;

            const viewportWidth = window.innerWidth;
            
            // Show simulator on desktop/tablet
            appDemo.style.display = 'flex';
            
            const viewportHeight = window.innerHeight;
            
            // Fixed simulator dimensions
            const simulatorWidth = 1200;
            const simulatorHeight = 580;
            
            // Add responsive padding for floating effect
            // Scale padding based on viewport width to avoid excessive gaps on narrow screens
            let padding;
            if (viewportWidth <= 768) {
                padding = 10; // Minimal padding on mobile
            } else if (viewportWidth <= 1024) {
                padding = 20; // Medium padding on tablet
            } else if (viewportWidth <= 1400) {
                padding = 30; // Standard padding on smaller desktops
            } else {
                padding = 40; // Full padding on large screens
            }
            
            const availableWidth = viewportWidth - (padding * 2);
            const availableHeight = viewportHeight - (padding * 2);

            // Calculate what zoom level the browser would use
            const widthZoom = availableWidth / simulatorWidth;
            const heightZoom = availableHeight / simulatorHeight;
            const zoomLevel = Math.min(widthZoom, heightZoom);
            
            // Clamp zoom level
            const finalZoom = Math.max(0.1, Math.min(1, zoomLevel));

            // If zoom is too small, show screenshot instead
            if (finalZoom < 0.6) {
                appWindow.style.display = 'none';
                
                // Apply the same scaling to the screenshot as we would to the simulator
                appDemo.style.transform = `scale(${finalZoom})`;
                
                // Load screenshot fallback
                loadScreenshotFallback();
                
                let screenshotElement = document.getElementById('simulator-screenshot');
                if (!screenshotElement) {
                    screenshotElement = document.createElement('img');
                    screenshotElement.id = 'simulator-screenshot';
                    screenshotElement.alt = 'Innioasis Updater Interface';
                    screenshotElement.style.cssText = `
                        width: 1200px;
                        height: 580px;
                        object-fit: cover;
                        border-radius: 16px;
                        box-shadow: 
                            0 20px 60px rgba(0, 0, 0, 0.3),
                            0 8px 25px rgba(0, 0, 0, 0.2),
                            0 0 0 1px rgba(255, 255, 255, 0.1);
                        margin: 0 auto;
                        display: block;
                        opacity: 1;
                        visibility: visible;
                        border: 1px solid var(--border-primary);
                        background: transparent;
                        z-index: 10;
                        position: relative;
                        transform-style: preserve-3d;
                        transition: transform 0.2s ease;
                    `;
                    
                    // Apply the same background wallpaper as the hero banner
                    const heroBanner = document.querySelector('.hero-banner');
                    if (heroBanner) {
                        const heroBannerBg = heroBanner.style.background || heroBanner.style.backgroundImage;
                        if (heroBannerBg) {
                            console.log('Applying hero banner background to screenshot:', heroBannerBg);
                            screenshotElement.style.background = heroBannerBg;
                            screenshotElement.style.backgroundSize = 'cover';
                            screenshotElement.style.backgroundPosition = 'center center';
                        } else {
                            console.log('No hero banner background found to apply to screenshot');
                        }
                    }

                    // Smart screenshot loading with dark mode and format fallbacks
                    function loadScreenshot() {
                        const isDarkMode = document.body.getAttribute('data-theme') === 'dark';
                        const basePath = 'mtkclient/gui/images/';
                        
                        // Enhanced screenshot paths with Windows-specific and general fallbacks
                        const imagePaths = [];
                        if (isDarkMode) {
                            imagePaths.push(basePath + 'screenshot_dark.jpg');
                            imagePaths.push(basePath + 'screenshot_dark.png');
                        }
                        // Add Windows-specific screenshot
                        imagePaths.push(basePath + 'screenshot_win.png');
                        imagePaths.push(basePath + 'screenshot.jpg');
                        imagePaths.push(basePath + 'screenshot.png');
                        
                        console.log('Screenshot paths to try:', imagePaths);
                        
                        let currentIndex = 0;
                        
                        function tryNextImage() {
                            if (currentIndex >= imagePaths.length) {
                                screenshotElement.style.display = 'none';
                                const placeholder = document.createElement('div');
                                placeholder.id = 'simulator-placeholder';
                                placeholder.innerHTML = `
                                    <div style="
                                        background: transparent;
                                        border-radius: 16px;
                                        padding: 60px 40px;
                                        text-align: center;
                                        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 8px 25px rgba(0, 0, 0, 0.2);
                                        border: 1px solid var(--border-primary);
                                        max-width: 1200px;
                                        margin: 0 auto;
                                    ">
                                        <h3 style="color: var(--text-primary); margin-bottom: 20px;">Innioasis Updater</h3>
                                        <p style="color: var(--text-secondary); margin-bottom: 30px;">Official firmware installation tool for your Y1 device</p>
                                        <div style="
                                            background: var(--bg-tertiary);
                                            border-radius: 8px;
                                            padding: 20px;
                                            color: var(--text-primary);
                                            font-size: 14px;
                                        ">
                                            <strong>Interface Preview</strong><br>
                                            This is a scaled-down view of the Innioasis Updater interface.
                                            For the full interactive experience, please use a larger screen or download the app.
                                        </div>
                                    </div>
                                `;
                                appDemo.appendChild(placeholder);
                                return;
                            }
                            
                            screenshotElement.src = imagePaths[currentIndex];
                            currentIndex++;
                        }
                        
                        screenshotElement.onload = function() {
                            screenshotElement.style.display = 'block';
                        };
                        
                        screenshotElement.onerror = function() {
                            tryNextImage();
                        };
                        
                        tryNextImage();
                    }
                    
                    loadScreenshot();
                    appDemo.appendChild(screenshotElement);
                } else {
                    screenshotElement.style.display = 'block';
                    appDemo.style.transform = `scale(${finalZoom})`;
                }
            } else {
                // Show the simulator and hide screenshot/placeholder
                appWindow.style.display = 'block';

                const screenshotElement = document.getElementById('simulator-screenshot');
                if (screenshotElement) {
                    screenshotElement.style.display = 'none';
                }

                const placeholderElement = document.getElementById('simulator-placeholder');
                if (placeholderElement) {
                    placeholderElement.style.display = 'none';
                }

                // Use browser's native zoom behavior
                if (finalZoom < 0.8) {
                    appDemo.style.transform = `scale(${finalZoom})`;
                    appDemo.style.zoom = '1';
                } else {
                    appDemo.style.zoom = finalZoom;
                    appDemo.style.transform = 'none';
                }
            }

            // Set padding to maintain floating effect
            appDemo.style.padding = `${padding}px`;
            
            // Scale the hero-banner height and padding proportionately with the simulator
            const heroBanner = document.querySelector('.hero-banner');
            if (heroBanner) {
                // Calculate proportional dimensions based on simulator scale
                const baseHeight = 700; // Base height for full-size simulator (includes floating space)
                const basePadding = 60; // Base padding for floating effect
                
                const scaledHeight = Math.max(400, baseHeight * finalZoom); // Minimum height for floating effect
                const scaledPadding = Math.max(20, basePadding * finalZoom); // Minimum padding
                
                heroBanner.style.height = `${scaledHeight}px`;
                heroBanner.style.minHeight = `${scaledHeight}px`;
                heroBanner.style.padding = `${scaledPadding}px 20px`; // Equal top/bottom padding for floating
                
                console.log(`Scaled hero-banner: height=${scaledHeight}px, padding=${scaledPadding}px (zoom: ${finalZoom})`);
            }
            
            // Apply the same scaling to modals and dialogs within the simulator
            updateModalScaling(finalZoom);
        }
        
        // Function to dynamically scale modals and dialogs to match simulator scaling
        function updateModalScaling(scaleFactor) {
            const modals = document.querySelectorAll('.app-content .app-modal-overlay, .app-content .app-dialog-overlay');
            modals.forEach(modal => {
                // Apply the same scale factor as the simulator
                modal.style.transform = `scale(${scaleFactor})`;
                modal.style.transformOrigin = 'center center';
                
                // Ensure proper z-index and visibility
                modal.style.zIndex = '10000';
                modal.style.position = 'absolute';
                modal.style.top = '0';
                modal.style.left = '0';
                modal.style.right = '0';
                modal.style.bottom = '0';
                modal.style.width = '100%';
                modal.style.height = '100%';
            });
        }

        // Throttled resize handler for better performance
        let resizeTimeout;
        function handleResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(updateSimulatorScale, 16); // ~60fps
        }

        // Reload screenshot when theme changes
        function reloadScreenshot() {
            const screenshotElement = document.getElementById('simulator-screenshot');
            if (screenshotElement && screenshotElement.style.display !== 'none') {
                const isDarkMode = document.body.getAttribute('data-theme') === 'dark';
                const basePath = 'mtkclient/gui/images/';
                
                // Try dark mode first if in dark mode, then regular, then PNG fallbacks
                const imagePaths = [];
                if (isDarkMode) {
                    imagePaths.push(basePath + 'screenshot_dark.jpg');
                    imagePaths.push(basePath + 'screenshot_dark.png');
                }
                imagePaths.push(basePath + 'screenshot.jpg');
                imagePaths.push(basePath + 'screenshot.png');
                
                let currentIndex = 0;
                
                function tryNextImage() {
                    if (currentIndex >= imagePaths.length) {
                        console.log('All screenshot images failed to load');
                        return;
                    }
                    
                    screenshotElement.src = imagePaths[currentIndex];
                    currentIndex++;
                }
                
                screenshotElement.onload = function() {
                    console.log('Screenshot reloaded:', screenshotElement.src);
                };
                
                screenshotElement.onerror = function() {
                    console.log('Failed to load:', screenshotElement.src);
                    tryNextImage();
                };
                
                tryNextImage();
            }
        }

        // Download Counter Functions - Real Data Only! ðŸ“Š
        async function fetchDownloadStats() {
            try {
                console.log('Fetching download stats with token support...');
                // Fetch release data from GitHub API using centralized function
                const response = await makeGitHubAPIRequest('https://api.github.com/repos/team-slide/Innioasis-Updater/releases');
                
                if (!response.ok) {
                    throw new Error(`GitHub API request failed: ${response.status}`);
                }
                
                const releases = await response.json();
                
                let totalDownloads = 0;
                let latestReleaseDownloads = 0;
                let releasesCount = releases.length;
                
                // Calculate total downloads from all releases
                releases.forEach((release, index) => {
                    if (release.assets) {
                        let releaseDownloads = 0;
                        release.assets.forEach(asset => {
                            const count = asset.download_count || 0;
                            totalDownloads += count;
                            releaseDownloads += count;
                        });
                        
                        // Get downloads for the latest release (index 0)
                        if (index === 0) {
                            latestReleaseDownloads = releaseDownloads;
                        }
                    }
                });
                
                // Format numbers
                const formatNumber = (num) => {
                    if (num >= 1000000) {
                        return (num / 1000000).toFixed(1) + 'M';
                    } else if (num >= 1000) {
                        return (num / 1000).toFixed(1) + 'K';
                    }
                    return num.toLocaleString();
                };
                
                // Update the subtitle with real data
                const downloadCountEl = document.getElementById('download-count');
                
                if (downloadCountEl) {
                    downloadCountEl.textContent = formatNumber(totalDownloads);
                    downloadCountEl.style.color = '#34d399'; // Success green
                }
                
                console.log('ðŸ“Š Real download stats loaded:', { 
                    totalDownloads, 
                    latestReleaseDownloads, 
                    releasesCount 
                });
                
            } catch (error) {
                console.warn('Could not fetch download stats:', error);
                
                // Show error state for subtitle
                const downloadCountEl = document.getElementById('download-count');
                
                if (downloadCountEl) {
                    downloadCountEl.textContent = 'thousands of';
                    downloadCountEl.style.color = '#f87171';
                }
            }
        }

        // Simple background loading system
        function loadPlatformBackground() {
            const platformInfo = detectDetailedPlatform();
            const heroBanner = document.querySelector('.hero-banner');
            
            if (!heroBanner) {
                console.error('Hero banner not found! Cannot apply background.');
                return;
            }
            
            console.log(`Setting background for ${platformInfo.platform}`);
            
            // Determine screenshot URL based on platform
            let screenshotUrl;
            if (platformInfo.platform === 'windows') {
                screenshotUrl = 'https://innioasis.app/mtkclient/gui/images/screenshot_win.jpg';
            } else {
                screenshotUrl = 'https://innioasis.app/mtkclient/gui/images/screenshot.png';
            }
            
            // Apply background directly
            heroBanner.style.background = `url('${screenshotUrl}') center center / cover no-repeat`;
            heroBanner.style.backgroundImage = `url('${screenshotUrl}')`;
            heroBanner.style.backgroundSize = 'cover';
            heroBanner.style.backgroundPosition = 'center center';
            heroBanner.style.backgroundRepeat = 'no-repeat';
            
            console.log(`Background set to: ${screenshotUrl}`);
        }

        // Apply platform-specific styling and pre-select appropriate platform
        function initializePlatformSpecificContent() {
            const platform = detectPlatform();
            console.log(`Detected platform: ${platform}`);
            
            // Show/hide troubleshooting cards based on platform
            const windowsCards = document.querySelectorAll('.platform-windows');
            const macCards = document.querySelectorAll('.platform-mac');
            const nonWindowsCards = document.querySelectorAll('.platform-non-windows');
            
            if (platform === 'windows') {
                // Show Windows-specific troubleshooting cards
                windowsCards.forEach(card => {
                    card.style.display = 'block';
                });
                // Hide Mac-specific cards
                macCards.forEach(card => {
                    card.style.display = 'none';
                });
                // Hide non-Windows message
                nonWindowsCards.forEach(card => {
                    card.style.display = 'none';
                });
                console.log('Applied Windows-specific troubleshooting content');
            } else {
                // Hide Windows-specific troubleshooting cards
                windowsCards.forEach(card => {
                    card.style.display = 'none';
                });
                // Show Mac-specific cards (and general non-Windows content)
                macCards.forEach(card => {
                    card.style.display = 'block';
                });
                // Show non-Windows message for Linux/other platforms
                if (platform !== 'mac') {
                    nonWindowsCards.forEach(card => {
                        card.style.display = 'block';
                    });
                }
                console.log(`Applied ${platform}-specific troubleshooting content`);
            }
            
            // Pre-select "Get Started" button and hide all content initially
            // Remove any existing selections first
            document.querySelectorAll('.platform-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Hide all content sections initially
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Pre-select the "Get Started" button
            const getStartedCard = document.querySelector(`[data-platform="get-started"]`);
            if (getStartedCard) {
                getStartedCard.classList.add('selected');
                console.log('Pre-selected "Get Started" button, content hidden until user clicks platform');
            }
            
            console.log('All content collapsed by default - user must select platform to reveal info');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Ensure scrolling is enabled on page load
            restoreScrolling();
            
            // Disable theme detection for quick rollout - force light theme
            localStorage.setItem('theme', 'light');
            applyTheme('light');
            
            // Apply platform-specific content immediately
            initializePlatformSpecificContent();
            
            // Load platform-specific wallpaper with debugging
            console.log('Starting wallpaper loading...');
            setTimeout(() => {
                loadPlatformBackground();
            }, 100); // Small delay to ensure DOM is ready
            
            // Start download stats immediately (unauthenticated first), load tokens in background for failover
            fetchDownloadStats();
            
            // Load API tokens in background for future use and failover
            loadApiTokens().then(tokens => {
                apiTokens = tokens;
                console.log(`API tokens loaded in background: ${tokens.length} tokens available for failover`);
            }).catch(error => {
                console.warn('Could not load API tokens for failover, will rely on unauthenticated calls only:', error);
            });
            
            // Don't auto-select content - user must click platform card to reveal content
            
            // Initialize responsive scaling
            updateSimulatorScale();
            
            // Update scaling on window resize (throttled for performance)
            window.addEventListener('resize', handleResize);
            
            // Ensure any existing modals are properly scaled on initial load
            setTimeout(() => {
                const appDemo = document.querySelector('.app-demo');
                if (appDemo) {
                    const currentTransform = appDemo.style.transform;
                    const currentZoom = appDemo.style.zoom;
                    let scaleFactor = 1;
                    
                    if (currentTransform && currentTransform.includes('scale')) {
                        const match = currentTransform.match(/scale\(([\d.]+)\)/);
                        if (match) scaleFactor = parseFloat(match[1]);
                    } else if (currentZoom && currentZoom !== '1' && currentZoom !== '') {
                        scaleFactor = parseFloat(currentZoom);
                    }
                    
                    updateModalScaling(scaleFactor);
                }
            }, 200); // Delay to ensure all elements are rendered
            
            // Initialize app demo with a small delay to ensure DOM is ready
            setTimeout(() => {
                console.log('Initializing app demo...');
                initializeAppDemo();
            }, 100);
            
            // Close modals when clicking outside
            document.getElementById('driverInfoModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeDriverInfo();
                }
            });
            
            document.getElementById('usbDevKitInfoModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeUsbDevKitInfo();
                }
            });
        });
    </script>
</body>
</html>
