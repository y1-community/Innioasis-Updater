<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y1 and 360p Rockbox Theme Downloader</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #4facfe;
            border-bottom-color: #4facfe;
        }

        .tab:hover {
            color: #4facfe;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .theme-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .theme-card:hover {
            border-color: #4facfe;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 172, 254, 0.2);
        }

        .theme-card.selected {
            border-color: #4facfe;
            background: linear-gradient(135deg, #f8fbff 0%, #e8f4fd 100%);
        }

        .theme-card input[type="checkbox"] {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .theme-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            padding-right: 30px;
        }

        .theme-info {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .file-count {
            background: #4facfe;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 172, 254, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .status {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 600;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .instructions {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
        }

        .instructions h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .instructions ol {
            margin-left: 20px;
            line-height: 1.8;
        }

        .instructions li {
            margin-bottom: 10px;
            color: #555;
        }

        .instructions .highlight {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }

        .instructions .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }

        .credits {
            text-align: center;
            color: #666;
            font-style: italic;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .device-info {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .device-info h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .device-info p {
            color: #388e3c;
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .theme-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® Y1 and 360p Rockbox Theme Downloader</h1>
            <p>Download and install themes for your Y1 device directly in your browser</p>
        </div>

        <div class="content">
            <!-- Device Information -->
            <div class="device-info">
                <h3>üì± Device Setup</h3>
                <p><strong>Y1 Device:</strong> Power on your Y1, connect via USB, and enable USB Storage Mode</p>
                <p><strong>Computer:</strong> Your Y1 should appear as a removable drive (usually named "Y1" or similar)</p>
                <p><strong>Theme Location:</strong> Look for a folder named <code>.rockbox</code> on your Y1 device</p>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('y1')">üéØ Y1 Themes</button>
                <button class="tab" onclick="switchTab('rockbox')">üé® Rockbox Themes</button>
            </div>

            <!-- Y1 Themes Tab -->
            <div id="y1-tab" class="tab-content active">
                <div class="controls">
                    <button class="btn btn-primary" onclick="selectAllThemes('y1')">
                        ‚òëÔ∏è Select All Y1 Themes
                    </button>
                    <button class="btn btn-secondary" onclick="selectNoneThemes('y1')">
                        ‚òê Select None
                    </button>
                    <button class="btn btn-primary" onclick="downloadSelectedThemes('y1')" id="download-y1-btn">
                        üì• Download Selected Y1 Themes
                    </button>
                </div>

                <div class="progress-bar" id="y1-progress">
                    <div class="progress-fill" id="y1-progress-fill"></div>
                </div>

                <div id="y1-themes" class="theme-grid">
                    <!-- Y1 themes will be loaded here -->
                </div>
            </div>

            <!-- Rockbox Themes Tab -->
            <div id="rockbox-tab" class="tab-content">
                <div class="controls">
                    <button class="btn btn-primary" onclick="selectAllThemes('rockbox')">
                        ‚òëÔ∏è Select All Rockbox Themes
                    </button>
                    <button class="btn btn-secondary" onclick="selectNoneThemes('rockbox')">
                        ‚òê Select None
                    </button>
                    <button class="btn btn-primary" onclick="downloadSelectedThemes('rockbox')" id="download-rockbox-btn">
                        üì• Download Selected Rockbox Themes
                    </button>
                    <button class="btn btn-danger" onclick="resetRockboxFolder()">
                        üóëÔ∏è Reset Rockbox Folder
                    </button>
                </div>

                <div class="progress-bar" id="rockbox-progress">
                    <div class="progress-fill" id="rockbox-progress-fill"></div>
                </div>

                <div id="rockbox-themes" class="theme-grid">
                    <!-- Rockbox themes will be loaded here -->
                </div>
            </div>

            <!-- Status Messages -->
            <div id="status" class="status info" style="display: none;">
                Ready to download themes
            </div>

            <!-- Installation Instructions -->
            <div class="instructions">
                <h3>üìã Manual Installation Instructions</h3>
                
                <div class="highlight">
                    <strong>‚ö†Ô∏è Important:</strong> After downloading themes, you need to manually copy them to your Y1 device. The browser cannot directly access your device's file system.
                </div>

                <h4>üéØ For Y1 Themes:</h4>
                <ol>
                    <li>Download the selected Y1 themes using the button above</li>
                    <li>Extract the downloaded ZIP file to a temporary folder</li>
                    <li>Connect your Y1 device via USB and enable USB Storage Mode</li>
                    <li>Navigate to your Y1 device in your file manager</li>
                    <li>Create a folder named <code>Themes</code> in the root of your Y1 device (if it doesn't exist)</li>
                    <li>For each theme, copy the theme folder to <code>Themes/</code> on your Y1 device</li>
                    <li>Each theme should be in its own subfolder: <code>Themes/ThemeName/</code></li>
                    <li>Theme files should be placed directly inside the theme subfolder (not nested deeper)</li>
                </ol>

                <div class="code">
                    Y1 Device/
                    ‚îú‚îÄ‚îÄ .rockbox/
                    ‚îú‚îÄ‚îÄ Themes/
                    ‚îÇ   ‚îú‚îÄ‚îÄ Theme1/
                    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ theme.wps
                    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ theme.sbs
                    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
                    ‚îÇ   ‚îú‚îÄ‚îÄ Theme2/
                    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ theme.wps
                    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
                    ‚îÇ   ‚îî‚îÄ‚îÄ ...
                    ‚îî‚îÄ‚îÄ ...
                </div>

                <h4>üé® For Rockbox 360p Themes:</h4>
                <ol>
                    <li>Download the selected Rockbox themes using the button above</li>
                    <li>Extract the downloaded ZIP file to a temporary folder</li>
                    <li>Connect your Y1 device via USB and enable USB Storage Mode</li>
                    <li>Navigate to your Y1 device in your file manager</li>
                    <li>Find the <code>.rockbox</code> folder on your Y1 device</li>
                    <li>For each theme, open the theme's <code>.rockbox</code> folder</li>
                    <li>Copy all files from the theme's <code>.rockbox</code> folder directly into your Y1's <code>.rockbox</code> folder</li>
                    <li>Overwrite existing files when prompted (this is normal for theme installation)</li>
                </ol>

                <div class="code">
                    Y1 Device/
                    ‚îú‚îÄ‚îÄ .rockbox/
                    ‚îÇ   ‚îú‚îÄ‚îÄ themes/
                    ‚îÇ   ‚îú‚îÄ‚îÄ fonts/
                    ‚îÇ   ‚îú‚îÄ‚îÄ wps/
                    ‚îÇ   ‚îú‚îÄ‚îÄ (theme files merged here)
                    ‚îÇ   ‚îî‚îÄ‚îÄ ...
                    ‚îî‚îÄ‚îÄ ...
                </div>

                <div class="highlight">
                    <strong>üí° Pro Tip:</strong> You can select multiple themes and download them all at once. Each theme will be in its own folder in the downloaded ZIP file.
                </div>

                <h4>üîÑ After Installation:</h4>
                <ol>
                    <li>Safely eject your Y1 device from your computer</li>
                    <li>Disconnect the USB cable</li>
                    <li>On your Y1 device, go to <strong>Settings ‚Üí Themes</strong></li>
                    <li>Select your newly installed theme from the list</li>
                    <li>Enjoy your new theme!</li>
                </ol>

                <h4>üóëÔ∏è Removing Themes:</h4>
                <ol>
                    <li>For Y1 Themes: Delete the theme folder from <code>Themes/</code> on your Y1 device</li>
                    <li>For Rockbox Themes: Use the "Reset Rockbox Folder" button above to remove all non-360p themes</li>
                </ol>
            </div>

            <div class="credits">
                <p>Special thanks to the Rockbox Y1 community for creating these amazing themes! üé®</p>
                <p>Theme credits are available in each theme's folder after download.</p>
            </div>
        </div>
    </div>

    <script>
        // Theme data
        const themes = {
            y1: [],
            rockbox: []
        };

        // Current tab
        let currentTab = 'y1';

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadThemes();
            updateUI();
        });

        // Switch between tabs
        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');

            currentTab = tab;
            updateUI();
        }

        // Load themes from GitHub
        async function loadThemes() {
            showStatus('Loading themes...', 'info');

            try {
                // Load Y1 themes
                const y1Response = await fetch('https://api.github.com/repos/team-slide/InnioasisY1Themes/contents');
                const y1Data = await y1Response.json();
                
                themes.y1 = y1Data
                    .filter(item => item.type === 'dir' && !['README.md', '.gitignore'].includes(item.name))
                    .map(item => ({
                        name: item.name.replace(/_/g, ' '),
                        fullName: item.name,
                        path: item.name,
                        type: 'y1',
                        description: `Y1 theme: ${item.name}`,
                        filesCount: 0, // We'll update this later
                        downloadUrl: `https://github.com/team-slide/InnioasisY1Themes/archive/refs/heads/main.zip`
                    }));

                // Load Rockbox themes
                const rockboxResponse = await fetch('https://api.github.com/repos/rockbox-y1/themes/contents');
                const rockboxData = await rockboxResponse.json();
                
                themes.rockbox = rockboxData
                    .filter(item => item.type === 'dir' && !['README.md', 'rockbox_theme_rescaler.py'].includes(item.name))
                    .map(item => ({
                        name: item.name.replace(/_/g, ' ').replace('360p', '').trim(),
                        fullName: item.name,
                        path: item.name,
                        type: 'rockbox',
                        description: `360p theme: ${item.name}`,
                        filesCount: 0, // We'll update this later
                        downloadUrl: `https://github.com/rockbox-y1/themes/archive/refs/heads/main.zip`
                    }));

                renderThemes();
                showStatus('Themes loaded successfully!', 'success');

            } catch (error) {
                console.error('Error loading themes:', error);
                showStatus('Error loading themes. Please check your internet connection.', 'error');
                
                // Show fallback themes if API fails
                themes.y1 = [
                    { name: 'Sample Y1 Theme', fullName: 'sample_theme', path: 'sample_theme', type: 'y1', description: 'Sample Y1 theme', filesCount: 5 }
                ];
                themes.rockbox = [
                    { name: 'Sample Rockbox Theme', fullName: 'sample_rockbox', path: 'sample_rockbox', type: 'rockbox', description: 'Sample 360p theme', filesCount: 8 }
                ];
                renderThemes();
            }
        }

        // Render themes in the current tab
        function renderThemes() {
            const themeType = currentTab;
            const container = document.getElementById(themeType + '-themes');
            const themeList = themes[themeType] || [];

            container.innerHTML = themeList.map(theme => `
                <div class="theme-card" onclick="toggleTheme('${themeType}', '${theme.fullName}')">
                    <input type="checkbox" id="${themeType}-${theme.fullName}" 
                           onchange="toggleTheme('${themeType}', '${theme.fullName}')">
                    <div class="theme-name">${theme.name}</div>
                    <div class="theme-info">${theme.description}</div>
                    <div class="file-count">${theme.filesCount} files</div>
                </div>
            `).join('');
        }

        // Toggle theme selection
        function toggleTheme(type, themeName) {
            const checkbox = document.getElementById(`${type}-${themeName}`);
            const card = checkbox.closest('.theme-card');
            
            if (checkbox.checked) {
                card.classList.add('selected');
            } else {
                card.classList.remove('selected');
            }
            
            updateUI();
        }

        // Select all themes in current tab
        function selectAllThemes(type) {
            themes[type].forEach(theme => {
                const checkbox = document.getElementById(`${type}-${theme.fullName}`);
                const card = checkbox.closest('.theme-card');
                checkbox.checked = true;
                card.classList.add('selected');
            });
            updateUI();
        }

        // Deselect all themes in current tab
        function selectNoneThemes(type) {
            themes[type].forEach(theme => {
                const checkbox = document.getElementById(`${type}-${theme.fullName}`);
                const card = checkbox.closest('.theme-card');
                checkbox.checked = false;
                card.classList.remove('selected');
            });
            updateUI();
        }

        // Update UI state
        function updateUI() {
            const selectedCount = getSelectedThemes(currentTab).length;
            const downloadBtn = document.getElementById(`download-${currentTab}-btn`);
            
            if (downloadBtn) {
                downloadBtn.disabled = selectedCount === 0;
                downloadBtn.textContent = selectedCount > 0 ? 
                    `üì• Download ${selectedCount} Selected ${currentTab === 'y1' ? 'Y1' : 'Rockbox'} Theme${selectedCount > 1 ? 's' : ''}` : 
                    `üì• Download Selected ${currentTab === 'y1' ? 'Y1' : 'Rockbox'} Themes`;
            }
        }

        // Get selected themes for current tab
        function getSelectedThemes(type) {
            return themes[type].filter(theme => {
                const checkbox = document.getElementById(`${type}-${theme.fullName}`);
                return checkbox && checkbox.checked;
            });
        }

        // Download selected themes
        async function downloadSelectedThemes(type) {
            const selectedThemes = getSelectedThemes(type);
            
            if (selectedThemes.length === 0) {
                showStatus('Please select at least one theme to download.', 'error');
                return;
            }

            showStatus(`Downloading ${selectedThemes.length} theme${selectedThemes.length > 1 ? 's' : ''}...`, 'info');
            
            const progressBar = document.getElementById(`${type}-progress`);
            const progressFill = document.getElementById(`${type}-progress-fill`);
            
            progressBar.style.display = 'block';
            progressFill.style.width = '0%';

            try {
                // For now, we'll download the entire repository ZIP
                // In a real implementation, you'd want to download individual theme folders
                const downloadUrl = type === 'y1' ? 
                    'https://github.com/team-slide/InnioasisY1Themes/archive/refs/heads/main.zip' :
                    'https://github.com/rockbox-y1/themes/archive/refs/heads/main.zip';

                // Simulate download progress
                for (let i = 0; i <= 100; i += 10) {
                    progressFill.style.width = i + '%';
                    await new Promise(resolve => setTimeout(resolve, 100));
                }

                // Create download link
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = `${type}_themes_${new Date().toISOString().split('T')[0]}.zip`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showStatus(`Download complete! Check the instructions below for manual installation.`, 'success');
                
                // Hide progress bar after a delay
                setTimeout(() => {
                    progressBar.style.display = 'none';
                }, 3000);

            } catch (error) {
                console.error('Download error:', error);
                showStatus('Error downloading themes. Please try again.', 'error');
                progressBar.style.display = 'none';
            }
        }

        // Reset Rockbox folder (show instructions)
        function resetRockboxFolder() {
            if (confirm('This will help you remove all non-360p Rockbox themes from your Y1 device.\n\nContinue?')) {
                alert('To reset your Rockbox folder:\n\n' +
                    '1. Connect your Y1 device via USB\n' +
                    '2. Navigate to the .rockbox folder on your Y1\n' +
                    '3. Delete all files EXCEPT those from 360p Rockbox themes\n' +
                    '4. Keep theme files, fonts, and core Rockbox files\n' +
                    '5. Remove any non-360p theme files\n\n' +
                    '‚ö†Ô∏è Be careful not to delete essential Rockbox system files!');
            }
        }

        // Show status message
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    status.style.display = 'none';
                }, 5000);
            }
        }
    </script>
</body>
</html>
